{"version":3,"file":"jsonb.cjs","names":["PgColumnBuilder","entityKind","PgColumn"],"sources":["../../../src/pg-core/columns/jsonb.ts"],"sourcesContent":["import { entityKind } from '~/entity.ts';\nimport type { PgTable } from '~/pg-core/table.ts';\nimport { PgColumn, PgColumnBuilder } from './common.ts';\n\nexport class PgJsonbBuilder extends PgColumnBuilder<{\n\tdataType: 'object json';\n\tdata: unknown;\n\tdriverParam: unknown;\n}> {\n\tstatic override readonly [entityKind]: string = 'PgJsonbBuilder';\n\n\tconstructor(name: string) {\n\t\tsuper(name, 'object json', 'PgJsonb');\n\t}\n\n\t/** @internal */\n\toverride build(table: PgTable<any>) {\n\t\treturn new PgJsonb(table, this.config as any);\n\t}\n}\n\nexport class PgJsonb extends PgColumn<'object json'> {\n\tstatic override readonly [entityKind]: string = 'PgJsonb';\n\n\tconstructor(table: PgTable<any>, config: PgJsonbBuilder['config']) {\n\t\tsuper(table, config);\n\t}\n\n\tgetSQLType(): string {\n\t\treturn 'jsonb';\n\t}\n\n\toverride mapToDriverValue(value: unknown): string {\n\t\treturn JSON.stringify(value);\n\t}\n\n\toverride mapFromDriverValue(value: unknown): unknown {\n\t\tif (typeof value === 'string') {\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(value);\n\t\t\t} catch {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n}\n\nexport function jsonb(name?: string): PgJsonbBuilder {\n\treturn new PgJsonbBuilder(name ?? '');\n}\n"],"mappings":";;;;;AAIA,IAAa,iBAAb,cAAoCA,+CAIjC;CACF,QAA0BC,0BAAsB;CAEhD,YAAY,MAAc;AACzB,QAAM,MAAM,eAAe,UAAU;;;CAItC,AAAS,MAAM,OAAqB;AACnC,SAAO,IAAI,QAAQ,OAAO,KAAK,OAAc;;;AAI/C,IAAa,UAAb,cAA6BC,wCAAwB;CACpD,QAA0BD,0BAAsB;CAEhD,YAAY,OAAqB,QAAkC;AAClE,QAAM,OAAO,OAAO;;CAGrB,aAAqB;AACpB,SAAO;;CAGR,AAAS,iBAAiB,OAAwB;AACjD,SAAO,KAAK,UAAU,MAAM;;CAG7B,AAAS,mBAAmB,OAAyB;AACpD,MAAI,OAAO,UAAU,SACpB,KAAI;AACH,UAAO,KAAK,MAAM,MAAM;UACjB;AACP,UAAO;;AAGT,SAAO;;;AAIT,SAAgB,MAAM,MAA+B;AACpD,QAAO,IAAI,eAAe,QAAQ,GAAG"}