{"version":3,"file":"binary.js","names":["str: string[]"],"sources":["../../../src/mysql-core/columns/binary.ts"],"sourcesContent":["import type { ColumnBaseConfig } from '~/column.ts';\nimport { entityKind } from '~/entity.ts';\nimport type { MySqlTable } from '~/mysql-core/table.ts';\nimport { getColumnNameAndConfig } from '~/utils.ts';\nimport { MySqlColumn, MySqlColumnBuilder } from './common.ts';\n\nexport class MySqlBinaryBuilder extends MySqlColumnBuilder<\n\t{\n\t\tdataType: 'string binary';\n\t\tdata: string;\n\t\tdriverParam: string;\n\t},\n\tMySqlBinaryConfig & { setLength: boolean }\n> {\n\tstatic override readonly [entityKind]: string = 'MySqlBinaryBuilder';\n\n\tconstructor(name: string, length: number | undefined) {\n\t\tsuper(name, 'string binary', 'MySqlBinary');\n\t\tthis.config.length = length ?? 1;\n\t\tthis.config.setLength = length !== undefined;\n\t}\n\n\t/** @internal */\n\toverride build(table: MySqlTable) {\n\t\treturn new MySqlBinary(table, this.config as any);\n\t}\n}\n\nexport class MySqlBinary<T extends ColumnBaseConfig<'string binary'>> extends MySqlColumn<\n\tT,\n\tMySqlBinaryConfig & { setLength: boolean }\n> {\n\tstatic override readonly [entityKind]: string = 'MySqlBinary';\n\n\toverride mapFromDriverValue(value: string | Buffer | Uint8Array): string {\n\t\tif (typeof value === 'string') return value;\n\t\tif (Buffer.isBuffer(value)) return value.toString();\n\n\t\tconst str: string[] = [];\n\t\tfor (const v of value) {\n\t\t\tstr.push(v === 49 ? '1' : '0');\n\t\t}\n\n\t\treturn str.join('');\n\t}\n\n\tgetSQLType(): string {\n\t\treturn this.config.setLength ? `binary(${this.length})` : `binary`;\n\t}\n}\n\nexport interface MySqlBinaryConfig {\n\tlength?: number;\n}\n\nexport function binary(\n\tconfig?: MySqlBinaryConfig,\n): MySqlBinaryBuilder;\nexport function binary(\n\tname: string,\n\tconfig?: MySqlBinaryConfig,\n): MySqlBinaryBuilder;\nexport function binary(a?: string | MySqlBinaryConfig, b: MySqlBinaryConfig = {}) {\n\tconst { name, config } = getColumnNameAndConfig<MySqlBinaryConfig>(a, b);\n\treturn new MySqlBinaryBuilder(name, config.length);\n}\n"],"mappings":";;;;;AAMA,IAAa,qBAAb,cAAwC,mBAOtC;CACD,QAA0B,cAAsB;CAEhD,YAAY,MAAc,QAA4B;AACrD,QAAM,MAAM,iBAAiB,cAAc;AAC3C,OAAK,OAAO,SAAS,UAAU;AAC/B,OAAK,OAAO,YAAY,WAAW;;;CAIpC,AAAS,MAAM,OAAmB;AACjC,SAAO,IAAI,YAAY,OAAO,KAAK,OAAc;;;AAInD,IAAa,cAAb,cAA8E,YAG5E;CACD,QAA0B,cAAsB;CAEhD,AAAS,mBAAmB,OAA6C;AACxE,MAAI,OAAO,UAAU,SAAU,QAAO;AACtC,MAAI,OAAO,SAAS,MAAM,CAAE,QAAO,MAAM,UAAU;EAEnD,MAAMA,MAAgB,EAAE;AACxB,OAAK,MAAM,KAAK,MACf,KAAI,KAAK,MAAM,KAAK,MAAM,IAAI;AAG/B,SAAO,IAAI,KAAK,GAAG;;CAGpB,aAAqB;AACpB,SAAO,KAAK,OAAO,YAAY,UAAU,KAAK,OAAO,KAAK;;;AAe5D,SAAgB,OAAO,GAAgC,IAAuB,EAAE,EAAE;CACjF,MAAM,EAAE,MAAM,WAAW,uBAA0C,GAAG,EAAE;AACxE,QAAO,IAAI,mBAAmB,MAAM,OAAO,OAAO"}