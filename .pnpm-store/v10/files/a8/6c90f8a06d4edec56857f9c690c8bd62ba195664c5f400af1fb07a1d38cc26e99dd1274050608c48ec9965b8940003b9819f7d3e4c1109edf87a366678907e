{"version":3,"file":"session.js","names":["client: AwsDataApiClient","queryString: string","params: unknown[]","typings: QueryTypingsValue[]","options: AwsDataApiSessionOptions","fields: SelectedFieldsOrdered | undefined","transactionId: string | undefined","_isResponseInArrayMode: boolean","customResultMapper?: (\n\t\t\trows: TIsRqbV2 extends true ? Record<string, unknown>[] : unknown[][],\n\t\t) => T['execute']","isRqbV2Query?: TIsRqbV2","row: Record<string, unknown>","relations: TRelations","schema: V1.RelationalSchemaConfig<TSchema> | undefined"],"sources":["../../../src/aws-data-api/pg/session.ts"],"sourcesContent":["import type { ColumnMetadata, ExecuteStatementCommandOutput, Field, RDSDataClient } from '@aws-sdk/client-rds-data';\nimport {\n\tBeginTransactionCommand,\n\tCommitTransactionCommand,\n\tExecuteStatementCommand,\n\tRollbackTransactionCommand,\n} from '@aws-sdk/client-rds-data';\nimport type * as V1 from '~/_relations.ts';\nimport type { Cache } from '~/cache/core/cache.ts';\nimport { NoopCache } from '~/cache/core/cache.ts';\nimport type { WithCacheConfig } from '~/cache/core/types.ts';\nimport { entityKind } from '~/entity.ts';\nimport type { Logger } from '~/logger.ts';\nimport { PgAsyncPreparedQuery, PgAsyncSession, PgAsyncTransaction } from '~/pg-core/async/session.ts';\nimport type { PgDialect } from '~/pg-core/dialect.ts';\nimport type { SelectedFieldsOrdered } from '~/pg-core/query-builders/select.types.ts';\nimport type { PgQueryResultHKT, PgTransactionConfig, PreparedQueryConfig } from '~/pg-core/session.ts';\nimport type { AnyRelations } from '~/relations.ts';\nimport { fillPlaceholders, type QueryTypingsValue, type QueryWithTypings, type SQL, sql } from '~/sql/sql.ts';\nimport { mapResultRow } from '~/utils.ts';\nimport { getValueFromDataApi, toValueParam } from '../common/index.ts';\n\nexport type AwsDataApiClient = RDSDataClient;\n\nexport class AwsDataApiPreparedQuery<\n\tT extends PreparedQueryConfig & { values: AwsDataApiPgQueryResult<unknown[]> },\n\tTIsRqbV2 extends boolean = false,\n> extends PgAsyncPreparedQuery<T> {\n\tstatic override readonly [entityKind]: string = 'AwsDataApiPreparedQuery';\n\n\tprivate rawQuery: ExecuteStatementCommand;\n\n\tconstructor(\n\t\tprivate client: AwsDataApiClient,\n\t\tprivate queryString: string,\n\t\tprivate params: unknown[],\n\t\tprivate typings: QueryTypingsValue[],\n\t\tprivate options: AwsDataApiSessionOptions,\n\t\tcache: Cache,\n\t\tqueryMetadata: {\n\t\t\ttype: 'select' | 'update' | 'delete' | 'insert';\n\t\t\ttables: string[];\n\t\t} | undefined,\n\t\tcacheConfig: WithCacheConfig | undefined,\n\t\tprivate fields: SelectedFieldsOrdered | undefined,\n\t\t/** @internal */\n\t\treadonly transactionId: string | undefined,\n\t\tprivate _isResponseInArrayMode: boolean,\n\t\tprivate customResultMapper?: (\n\t\t\trows: TIsRqbV2 extends true ? Record<string, unknown>[] : unknown[][],\n\t\t) => T['execute'],\n\t\tprivate isRqbV2Query?: TIsRqbV2,\n\t) {\n\t\tsuper({ sql: queryString, params }, cache, queryMetadata, cacheConfig);\n\t\tthis.rawQuery = new ExecuteStatementCommand({\n\t\t\tsql: queryString,\n\t\t\tparameters: [],\n\t\t\tsecretArn: options.secretArn,\n\t\t\tresourceArn: options.resourceArn,\n\t\t\tdatabase: options.database,\n\t\t\ttransactionId,\n\t\t\tincludeResultMetadata: isRqbV2Query || (!fields && !customResultMapper),\n\t\t});\n\t}\n\n\tasync execute(placeholderValues: Record<string, unknown> | undefined = {}): Promise<T['execute']> {\n\t\tif (this.isRqbV2Query) return this.executeRqbV2(placeholderValues);\n\n\t\tconst { fields, joinsNotNullableMap, customResultMapper } = this;\n\n\t\tconst result = await this.values(placeholderValues);\n\t\tif (!fields && !customResultMapper) {\n\t\t\tconst { columnMetadata, rows } = result;\n\t\t\tif (!columnMetadata) {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\tconst mappedRows = rows.map((sourceRow) => {\n\t\t\t\tconst row: Record<string, unknown> = {};\n\t\t\t\tfor (const [index, value] of sourceRow.entries()) {\n\t\t\t\t\tconst metadata = columnMetadata[index];\n\t\t\t\t\tif (!metadata) {\n\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t`Unexpected state: no column metadata found for index ${index}. Please report this issue on GitHub: https://github.com/drizzle-team/drizzle-orm/issues/new/choose`,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tif (!metadata.name) {\n\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t`Unexpected state: no column name for index ${index} found in the column metadata. Please report this issue on GitHub: https://github.com/drizzle-team/drizzle-orm/issues/new/choose`,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\trow[metadata.name] = value;\n\t\t\t\t}\n\t\t\t\treturn row;\n\t\t\t});\n\t\t\treturn Object.assign(result, { rows: mappedRows });\n\t\t}\n\n\t\treturn customResultMapper\n\t\t\t? (customResultMapper as (rows: unknown[][]) => T['execute'])(result.rows!)\n\t\t\t: result.rows!.map((row) => mapResultRow(fields!, row, joinsNotNullableMap));\n\t}\n\n\tprivate async executeRqbV2(placeholderValues: Record<string, unknown> | undefined = {}): Promise<T['execute']> {\n\t\tconst { customResultMapper } = this;\n\n\t\tconst result = await this.values(placeholderValues);\n\t\tconst { columnMetadata, rows } = result;\n\t\tif (!columnMetadata) {\n\t\t\treturn (customResultMapper as (rows: Record<string, unknown>[]) => T['execute'])(\n\t\t\t\trows as [],\n\t\t\t);\n\t\t}\n\t\tconst mappedRows = rows.map((sourceRow) => {\n\t\t\tconst row: Record<string, unknown> = {};\n\t\t\tfor (const [index, value] of sourceRow.entries()) {\n\t\t\t\tconst metadata = columnMetadata[index];\n\t\t\t\tif (!metadata) {\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t`Unexpected state: no column metadata found for index ${index}. Please report this issue on GitHub: https://github.com/drizzle-team/drizzle-orm/issues/new/choose`,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (!metadata.name) {\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t`Unexpected state: no column name for index ${index} found in the column metadata. Please report this issue on GitHub: https://github.com/drizzle-team/drizzle-orm/issues/new/choose`,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\trow[metadata.name] = value;\n\t\t\t}\n\t\t\treturn row;\n\t\t});\n\n\t\treturn (customResultMapper as (rows: Record<string, unknown>[]) => T['execute'])(\n\t\t\tmappedRows,\n\t\t);\n\t}\n\n\tasync all(placeholderValues?: Record<string, unknown> | undefined): Promise<T['all']> {\n\t\tconst result = await this.execute(placeholderValues);\n\t\tif (!this.fields && !this.customResultMapper) {\n\t\t\treturn (result as AwsDataApiPgQueryResult<unknown>).rows;\n\t\t}\n\t\treturn result;\n\t}\n\n\tasync values(placeholderValues: Record<string, unknown> = {}): Promise<T['values']> {\n\t\tconst params = fillPlaceholders(this.params, placeholderValues ?? {});\n\n\t\tthis.rawQuery.input.parameters = params.map((param, index) => ({\n\t\t\tname: `${index + 1}`,\n\t\t\t...toValueParam(param, this.typings[index]),\n\t\t}));\n\n\t\tthis.options.logger?.logQuery(this.rawQuery.input.sql!, this.rawQuery.input.parameters);\n\n\t\tconst result = await this.queryWithCache(this.queryString, params, async () => {\n\t\t\treturn await this.client.send(this.rawQuery);\n\t\t});\n\t\tconst rows = result.records?.map((row) => {\n\t\t\treturn row.map((field) => getValueFromDataApi(field));\n\t\t}) ?? [];\n\n\t\treturn {\n\t\t\t...result,\n\t\t\trows,\n\t\t};\n\t}\n\n\t/** @internal */\n\tmapResultRows(records: Field[][], columnMetadata: ColumnMetadata[]) {\n\t\treturn records.map((record) => {\n\t\t\tconst row: Record<string, unknown> = {};\n\t\t\tfor (const [index, field] of record.entries()) {\n\t\t\t\tconst { name } = columnMetadata[index]!;\n\t\t\t\trow[name ?? index] = getValueFromDataApi(field); // not what to default if name is undefined\n\t\t\t}\n\t\t\treturn row;\n\t\t});\n\t}\n\n\t/** @internal */\n\tisResponseInArrayMode(): boolean {\n\t\treturn this._isResponseInArrayMode;\n\t}\n}\n\nexport interface AwsDataApiSessionOptions {\n\tlogger?: Logger;\n\tcache?: Cache;\n\tdatabase: string;\n\tresourceArn: string;\n\tsecretArn: string;\n}\n\ninterface AwsDataApiQueryBase {\n\tresourceArn: string;\n\tsecretArn: string;\n\tdatabase: string;\n}\n\nexport class AwsDataApiSession<\n\tTFullSchema extends Record<string, unknown>,\n\tTRelations extends AnyRelations,\n\tTSchema extends V1.TablesRelationalConfig,\n> extends PgAsyncSession<AwsDataApiPgQueryResultHKT, TFullSchema, TRelations, TSchema> {\n\tstatic override readonly [entityKind]: string = 'AwsDataApiSession';\n\n\t/** @internal */\n\treadonly rawQuery: AwsDataApiQueryBase;\n\tprivate cache: Cache;\n\n\tconstructor(\n\t\t/** @internal */\n\t\treadonly client: AwsDataApiClient,\n\t\tdialect: PgDialect,\n\t\tprivate relations: TRelations,\n\t\tprivate schema: V1.RelationalSchemaConfig<TSchema> | undefined,\n\t\tprivate options: AwsDataApiSessionOptions,\n\t\t/** @internal */\n\t\treadonly transactionId: string | undefined,\n\t) {\n\t\tsuper(dialect);\n\t\tthis.rawQuery = {\n\t\t\tsecretArn: options.secretArn,\n\t\t\tresourceArn: options.resourceArn,\n\t\t\tdatabase: options.database,\n\t\t};\n\t\tthis.cache = options.cache ?? new NoopCache();\n\t}\n\n\tprepareQuery<\n\t\tT extends PreparedQueryConfig & {\n\t\t\tvalues: AwsDataApiPgQueryResult<unknown[]>;\n\t\t} = PreparedQueryConfig & {\n\t\t\tvalues: AwsDataApiPgQueryResult<unknown[]>;\n\t\t},\n\t>(\n\t\tquery: QueryWithTypings,\n\t\tfields: SelectedFieldsOrdered | undefined,\n\t\tname: string | undefined,\n\t\tisResponseInArrayMode: boolean,\n\t\tcustomResultMapper?: (rows: unknown[][]) => T['execute'],\n\t\tqueryMetadata?: { type: 'select' | 'update' | 'delete' | 'insert'; tables: string[] },\n\t\tcacheConfig?: WithCacheConfig,\n\t\ttransactionId?: string,\n\t): AwsDataApiPreparedQuery<T> {\n\t\treturn new AwsDataApiPreparedQuery(\n\t\t\tthis.client,\n\t\t\tquery.sql,\n\t\t\tquery.params,\n\t\t\tquery.typings ?? [],\n\t\t\tthis.options,\n\t\t\tthis.cache,\n\t\t\tqueryMetadata,\n\t\t\tcacheConfig,\n\t\t\tfields,\n\t\t\ttransactionId ?? this.transactionId,\n\t\t\tisResponseInArrayMode,\n\t\t\tcustomResultMapper,\n\t\t);\n\t}\n\n\tprepareRelationalQuery<T extends PreparedQueryConfig = PreparedQueryConfig>(\n\t\tquery: QueryWithTypings,\n\t\tfields: SelectedFieldsOrdered | undefined,\n\t\tname: string | undefined,\n\t\tcustomResultMapper: (rows: Record<string, unknown>[]) => T['execute'],\n\t\ttransactionId?: string,\n\t): PgAsyncPreparedQuery<T> {\n\t\treturn new AwsDataApiPreparedQuery(\n\t\t\tthis.client,\n\t\t\tquery.sql,\n\t\t\tquery.params,\n\t\t\tquery.typings ?? [],\n\t\t\tthis.options,\n\t\t\tthis.cache,\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\tfields,\n\t\t\ttransactionId ?? this.transactionId,\n\t\t\tfalse,\n\t\t\tcustomResultMapper,\n\t\t\ttrue,\n\t\t);\n\t}\n\n\toverride execute<T>(query: SQL): Promise<T> {\n\t\treturn this.prepareQuery<PreparedQueryConfig & { execute: T; values: AwsDataApiPgQueryResult<unknown[]> }>(\n\t\t\tthis.dialect.sqlToQuery(query),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\tfalse,\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\tthis.transactionId,\n\t\t).execute();\n\t}\n\n\toverride async transaction<T>(\n\t\ttransaction: (tx: AwsDataApiTransaction<TFullSchema, TRelations, TSchema>) => Promise<T>,\n\t\tconfig?: PgTransactionConfig | undefined,\n\t): Promise<T> {\n\t\tconst { transactionId } = await this.client.send(new BeginTransactionCommand(this.rawQuery));\n\t\tconst session = new AwsDataApiSession(\n\t\t\tthis.client,\n\t\t\tthis.dialect,\n\t\t\tthis.relations,\n\t\t\tthis.schema,\n\t\t\tthis.options,\n\t\t\ttransactionId,\n\t\t);\n\t\tconst tx = new AwsDataApiTransaction<TFullSchema, TRelations, TSchema>(\n\t\t\tthis.dialect,\n\t\t\tsession,\n\t\t\tthis.relations,\n\t\t\tthis.schema,\n\t\t\tundefined,\n\t\t\ttrue,\n\t\t);\n\t\tif (config) {\n\t\t\tawait tx.setTransaction(config);\n\t\t}\n\t\ttry {\n\t\t\tconst result = await transaction(tx);\n\t\t\tawait this.client.send(new CommitTransactionCommand({ ...this.rawQuery, transactionId }));\n\t\t\treturn result;\n\t\t} catch (e) {\n\t\t\tawait this.client.send(new RollbackTransactionCommand({ ...this.rawQuery, transactionId }));\n\t\t\tthrow e;\n\t\t}\n\t}\n}\n\nexport class AwsDataApiTransaction<\n\tTFullSchema extends Record<string, unknown>,\n\tTRelations extends AnyRelations,\n\tTSchema extends V1.TablesRelationalConfig,\n> extends PgAsyncTransaction<AwsDataApiPgQueryResultHKT, TFullSchema, TRelations, TSchema> {\n\tstatic override readonly [entityKind]: string = 'AwsDataApiTransaction';\n\n\toverride async transaction<T>(\n\t\ttransaction: (tx: AwsDataApiTransaction<TFullSchema, TRelations, TSchema>) => Promise<T>,\n\t): Promise<T> {\n\t\tconst savepointName = `sp${this.nestedIndex + 1}`;\n\t\tconst tx = new AwsDataApiTransaction<TFullSchema, TRelations, TSchema>(\n\t\t\tthis.dialect,\n\t\t\tthis.session,\n\t\t\tthis.relations,\n\t\t\tthis.schema,\n\t\t\tthis.nestedIndex + 1,\n\t\t);\n\t\tawait this.session.execute(sql.raw(`savepoint ${savepointName}`));\n\t\ttry {\n\t\t\tconst result = await transaction(tx);\n\t\t\tawait this.session.execute(sql.raw(`release savepoint ${savepointName}`));\n\t\t\treturn result;\n\t\t} catch (e) {\n\t\t\tawait this.session.execute(sql.raw(`rollback to savepoint ${savepointName}`));\n\t\t\tthrow e;\n\t\t}\n\t}\n}\n\nexport type AwsDataApiPgQueryResult<T> = ExecuteStatementCommandOutput & { rows: T[] };\n\nexport interface AwsDataApiPgQueryResultHKT extends PgQueryResultHKT {\n\ttype: AwsDataApiPgQueryResult<any>;\n}\n"],"mappings":"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"}