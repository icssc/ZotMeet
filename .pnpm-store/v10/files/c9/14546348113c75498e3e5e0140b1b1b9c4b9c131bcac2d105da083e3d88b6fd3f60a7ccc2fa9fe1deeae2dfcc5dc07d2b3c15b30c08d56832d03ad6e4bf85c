{"version":3,"file":"utils.cjs","names":["bytes: number[]","srid: number | undefined"],"sources":["../../../src/cockroach-core/columns/utils.ts"],"sourcesContent":["function hexToBytes(hex: string): Uint8Array {\n\tconst bytes: number[] = [];\n\tfor (let c = 0; c < hex.length; c += 2) {\n\t\tbytes.push(Number.parseInt(hex.slice(c, c + 2), 16));\n\t}\n\treturn new Uint8Array(bytes);\n}\n\nfunction bytesToFloat64(bytes: Uint8Array, offset: number): number {\n\tconst buffer = new ArrayBuffer(8);\n\tconst view = new DataView(buffer);\n\tfor (let i = 0; i < 8; i++) {\n\t\tview.setUint8(i, bytes[offset + i]!);\n\t}\n\treturn view.getFloat64(0, true);\n}\n\nexport function parseEWKB(hex: string): { srid: number | undefined; point: [number, number] } {\n\tconst bytes = hexToBytes(hex);\n\n\tlet offset = 0;\n\n\t// Byte order: 1 is little-endian, 0 is big-endian\n\tconst byteOrder = bytes[offset];\n\toffset += 1;\n\n\tconst view = new DataView(bytes.buffer);\n\tconst geomType = view.getUint32(offset, byteOrder === 1);\n\toffset += 4;\n\n\tlet srid: number | undefined;\n\tif (geomType & 0x20000000) { // SRID flag\n\t\tsrid = view.getUint32(offset, byteOrder === 1);\n\t\toffset += 4;\n\t}\n\n\tif ((geomType & 0xFFFF) === 1) {\n\t\tconst x = bytesToFloat64(bytes, offset);\n\t\toffset += 8;\n\t\tconst y = bytesToFloat64(bytes, offset);\n\t\toffset += 8;\n\n\t\treturn { srid, point: [x, y] };\n\t}\n\n\tthrow new Error('Unsupported geometry type');\n}\n"],"mappings":";;AAAA,SAAS,WAAW,KAAyB;CAC5C,MAAMA,QAAkB,EAAE;AAC1B,MAAK,IAAI,IAAI,GAAG,IAAI,IAAI,QAAQ,KAAK,EACpC,OAAM,KAAK,OAAO,SAAS,IAAI,MAAM,GAAG,IAAI,EAAE,EAAE,GAAG,CAAC;AAErD,QAAO,IAAI,WAAW,MAAM;;AAG7B,SAAS,eAAe,OAAmB,QAAwB;CAClE,MAAM,yBAAS,IAAI,YAAY,EAAE;CACjC,MAAM,OAAO,IAAI,SAAS,OAAO;AACjC,MAAK,IAAI,IAAI,GAAG,IAAI,GAAG,IACtB,MAAK,SAAS,GAAG,MAAM,SAAS,GAAI;AAErC,QAAO,KAAK,WAAW,GAAG,KAAK;;AAGhC,SAAgB,UAAU,KAAoE;CAC7F,MAAM,QAAQ,WAAW,IAAI;CAE7B,IAAI,SAAS;CAGb,MAAM,YAAY,MAAM;AACxB,WAAU;CAEV,MAAM,OAAO,IAAI,SAAS,MAAM,OAAO;CACvC,MAAM,WAAW,KAAK,UAAU,QAAQ,cAAc,EAAE;AACxD,WAAU;CAEV,IAAIC;AACJ,KAAI,WAAW,WAAY;AAC1B,SAAO,KAAK,UAAU,QAAQ,cAAc,EAAE;AAC9C,YAAU;;AAGX,MAAK,WAAW,WAAY,GAAG;EAC9B,MAAM,IAAI,eAAe,OAAO,OAAO;AACvC,YAAU;EACV,MAAM,IAAI,eAAe,OAAO,OAAO;AACvC,YAAU;AAEV,SAAO;GAAE;GAAM,OAAO,CAAC,GAAG,EAAE;GAAE;;AAG/B,OAAM,IAAI,MAAM,4BAA4B"}