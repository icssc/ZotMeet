{"version":3,"file":"enum.js","names":[],"sources":["../../../src/singlestore-core/columns/enum.ts"],"sourcesContent":["import type { HasGenerated } from '~/column-builder.ts';\nimport type { ColumnBaseConfig } from '~/column.ts';\nimport { entityKind } from '~/entity.ts';\nimport type { SingleStoreTable } from '~/singlestore-core/table.ts';\nimport type { SQL } from '~/sql/index.ts';\nimport { getColumnNameAndConfig, type Writable } from '~/utils.ts';\nimport { SingleStoreColumn, SingleStoreColumnBuilder, type SingleStoreGeneratedColumnConfig } from './common.ts';\n\nexport class SingleStoreEnumColumnBuilder<TEnum extends [string, ...string[]]> extends SingleStoreColumnBuilder<{\n\tdataType: 'string enum';\n\tdata: TEnum[number];\n\tdriverParam: string;\n\tenumValues: TEnum;\n}, { enumValues: TEnum }> {\n\toverride generatedAlwaysAs(\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\tas: SQL<unknown> | (() => SQL) | TEnum[number],\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\tconfig?: SingleStoreGeneratedColumnConfig,\n\t): HasGenerated<this, { type: 'always' }> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\tstatic override readonly [entityKind]: string = 'SingleStoreEnumColumnBuilder';\n\n\tconstructor(name: string, values: TEnum) {\n\t\tsuper(name, 'string enum', 'SingleStoreEnumColumn');\n\t\tthis.config.enumValues = values;\n\t}\n\n\t/** @internal */\n\toverride build(table: SingleStoreTable) {\n\t\treturn new SingleStoreEnumColumn(\n\t\t\ttable,\n\t\t\tthis.config as any,\n\t\t);\n\t}\n}\n\nexport class SingleStoreEnumColumn<T extends ColumnBaseConfig<'string enum'>>\n\textends SingleStoreColumn<T, { enumValues: T['enumValues'] }>\n{\n\tstatic override readonly [entityKind]: string = 'SingleStoreEnumColumn';\n\n\toverride readonly enumValues = this.config.enumValues;\n\n\tgetSQLType(): string {\n\t\treturn `enum(${this.enumValues!.map((value) => `'${value}'`).join(',')})`;\n\t}\n}\n\nexport function singlestoreEnum<U extends string, T extends Readonly<[U, ...U[]]>>(\n\tvalues: T | Writable<T>,\n): SingleStoreEnumColumnBuilder<Writable<T>>;\nexport function singlestoreEnum<U extends string, T extends Readonly<[U, ...U[]]>>(\n\tname: string,\n\tvalues: T | Writable<T>,\n): SingleStoreEnumColumnBuilder<Writable<T>>;\nexport function singlestoreEnum(\n\ta?: string | readonly [string, ...string[]] | [string, ...string[]],\n\tb?: readonly [string, ...string[]] | [string, ...string[]],\n): any {\n\tconst { name, config: values } = getColumnNameAndConfig<readonly [string, ...string[]] | [string, ...string[]]>(a, b);\n\n\tif (values.length === 0) {\n\t\tthrow new Error(`You have an empty array for \"${name}\" enum values`);\n\t}\n\n\treturn new SingleStoreEnumColumnBuilder(name, values as any);\n}\n"],"mappings":";;;;;AAQA,IAAa,+BAAb,cAAuF,yBAK7D;CACzB,AAAS,kBAER,IAEA,QACyC;AACzC,QAAM,IAAI,MAAM,0BAA0B;;CAE3C,QAA0B,cAAsB;CAEhD,YAAY,MAAc,QAAe;AACxC,QAAM,MAAM,eAAe,wBAAwB;AACnD,OAAK,OAAO,aAAa;;;CAI1B,AAAS,MAAM,OAAyB;AACvC,SAAO,IAAI,sBACV,OACA,KAAK,OACL;;;AAIH,IAAa,wBAAb,cACS,kBACT;CACC,QAA0B,cAAsB;CAEhD,AAAkB,aAAa,KAAK,OAAO;CAE3C,aAAqB;AACpB,SAAO,QAAQ,KAAK,WAAY,KAAK,UAAU,IAAI,MAAM,GAAG,CAAC,KAAK,IAAI,CAAC;;;AAWzE,SAAgB,gBACf,GACA,GACM;CACN,MAAM,EAAE,MAAM,QAAQ,WAAW,uBAA+E,GAAG,EAAE;AAErH,KAAI,OAAO,WAAW,EACrB,OAAM,IAAI,MAAM,gCAAgC,KAAK,eAAe;AAGrE,QAAO,IAAI,6BAA6B,MAAM,OAAc"}