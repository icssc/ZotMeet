{"version":3,"file":"halfvec.cjs","names":["PgColumnBuilder","entityKind","PgColumn"],"sources":["../../../../src/pg-core/columns/vector_extension/halfvec.ts"],"sourcesContent":["import { entityKind } from '~/entity.ts';\nimport type { PgTable } from '~/pg-core/table.ts';\nimport { getColumnNameAndConfig } from '~/utils.ts';\nimport { PgColumn, PgColumnBuilder } from '../common.ts';\n\nexport class PgHalfVectorBuilder extends PgColumnBuilder<\n\t{\n\t\tdataType: 'array halfvector';\n\t\tdata: number[];\n\t\tdriverParam: string;\n\t},\n\t{ length: number; isLengthExact: true }\n> {\n\tstatic override readonly [entityKind]: string = 'PgHalfVectorBuilder';\n\n\tconstructor(name: string, config: PgHalfVectorConfig) {\n\t\tsuper(name, 'array halfvector', 'PgHalfVector');\n\t\tthis.config.length = config.dimensions;\n\t\tthis.config.isLengthExact = true;\n\t}\n\n\t/** @internal */\n\toverride build(table: PgTable<any>) {\n\t\treturn new PgHalfVector(\n\t\t\ttable,\n\t\t\tthis.config as any,\n\t\t);\n\t}\n}\n\nexport class PgHalfVector extends PgColumn<'array halfvector'> {\n\tstatic override readonly [entityKind]: string = 'PgHalfVector';\n\n\tgetSQLType(): string {\n\t\treturn `halfvec(${this.length})`;\n\t}\n\n\toverride mapToDriverValue(value: unknown): unknown {\n\t\treturn JSON.stringify(value);\n\t}\n\n\toverride mapFromDriverValue(value: string): unknown {\n\t\treturn value\n\t\t\t.slice(1, -1)\n\t\t\t.split(',')\n\t\t\t.map((v) => Number.parseFloat(v));\n\t}\n}\n\nexport interface PgHalfVectorConfig {\n\tdimensions: number;\n}\n\nexport function halfvec(\n\tconfig: PgHalfVectorConfig,\n): PgHalfVectorBuilder;\nexport function halfvec(\n\tname: string,\n\tconfig: PgHalfVectorConfig,\n): PgHalfVectorBuilder;\nexport function halfvec(a: string | PgHalfVectorConfig, b?: PgHalfVectorConfig) {\n\tconst { name, config } = getColumnNameAndConfig<PgHalfVectorConfig>(a, b);\n\treturn new PgHalfVectorBuilder(name, config);\n}\n"],"mappings":";;;;;;AAKA,IAAa,sBAAb,cAAyCA,+CAOvC;CACD,QAA0BC,0BAAsB;CAEhD,YAAY,MAAc,QAA4B;AACrD,QAAM,MAAM,oBAAoB,eAAe;AAC/C,OAAK,OAAO,SAAS,OAAO;AAC5B,OAAK,OAAO,gBAAgB;;;CAI7B,AAAS,MAAM,OAAqB;AACnC,SAAO,IAAI,aACV,OACA,KAAK,OACL;;;AAIH,IAAa,eAAb,cAAkCC,wCAA6B;CAC9D,QAA0BD,0BAAsB;CAEhD,aAAqB;AACpB,SAAO,WAAW,KAAK,OAAO;;CAG/B,AAAS,iBAAiB,OAAyB;AAClD,SAAO,KAAK,UAAU,MAAM;;CAG7B,AAAS,mBAAmB,OAAwB;AACnD,SAAO,MACL,MAAM,GAAG,GAAG,CACZ,MAAM,IAAI,CACV,KAAK,MAAM,OAAO,WAAW,EAAE,CAAC;;;AAepC,SAAgB,QAAQ,GAAgC,GAAwB;CAC/E,MAAM,EAAE,MAAM,kDAAsD,GAAG,EAAE;AACzE,QAAO,IAAI,oBAAoB,MAAM,OAAO"}