{"version":3,"sources":["../../../../src/lib/typescript/type-paths.ts"],"sourcesContent":["import path from 'path'\n\n/**\n * Gets the glob patterns for type definition directories in tsconfig.\n * When isolatedDevBuild is enabled, Next.js uses different distDir paths:\n * - Development: \"{distDir}/dev\"\n * - Production: \"{distDir}\"\n */\nexport function getTypeDefinitionGlobPatterns(\n  distDir: string,\n  isolatedDevBuild: boolean\n): string[] {\n  const distDirPosix =\n    path.win32.sep === path.sep\n      ? distDir.replaceAll(path.win32.sep, path.posix.sep)\n      : distDir\n\n  const typeGlobPatterns: string[] = [`${distDirPosix}/types/**/*.ts`]\n\n  // When isolatedDevBuild is enabled, include both .next/types and .next/dev/types\n  // to avoid tsconfig churn when switching between dev/build modes\n  if (isolatedDevBuild) {\n    typeGlobPatterns.push(\n      process.env.NODE_ENV === 'development'\n        ? // In dev, distDir is \"{distDir}/dev\", so also include \"{distDir}/types\"\n          `${distDirPosix.replace(/\\/dev$/, '')}/types/**/*.ts`\n        : // In build, distDir is \"{distDir}\", so also include \"{distDir}/dev/types\"\n          `${distDirPosix}/dev/types/**/*.ts`\n    )\n    // Sort for consistent order\n    typeGlobPatterns.sort((a, b) => a.length - b.length)\n  }\n\n  return typeGlobPatterns\n}\n\n/**\n * Gets the absolute path to the dev types directory for filtering during type-checking.\n * Returns null if isolatedDevBuild is disabled or in dev mode (where dev types are the main types).\n */\nexport function getDevTypesPath(\n  baseDir: string,\n  distDir: string,\n  isolatedDevBuild: boolean\n): string | null {\n  if (!isolatedDevBuild) {\n    return null\n  }\n\n  const isDev = process.env.NODE_ENV === 'development'\n  if (isDev) {\n    // In dev mode, dev types are the main types, so no need to filter\n    return null\n  }\n\n  // In build mode, dev types are at \"{baseDir}/{distDir}/dev/types\" and should be filtered\n  return path.join(baseDir, distDir, 'dev', 'types')\n}\n"],"names":["path","getTypeDefinitionGlobPatterns","distDir","isolatedDevBuild","distDirPosix","win32","sep","replaceAll","posix","typeGlobPatterns","push","process","env","NODE_ENV","replace","sort","a","b","length","getDevTypesPath","baseDir","isDev","join"],"mappings":"AAAA,OAAOA,UAAU,OAAM;AAEvB;;;;;CAKC,GACD,OAAO,SAASC,8BACdC,OAAe,EACfC,gBAAyB;IAEzB,MAAMC,eACJJ,KAAKK,KAAK,CAACC,GAAG,KAAKN,KAAKM,GAAG,GACvBJ,QAAQK,UAAU,CAACP,KAAKK,KAAK,CAACC,GAAG,EAAEN,KAAKQ,KAAK,CAACF,GAAG,IACjDJ;IAEN,MAAMO,mBAA6B;QAAC,GAAGL,aAAa,cAAc,CAAC;KAAC;IAEpE,iFAAiF;IACjF,iEAAiE;IACjE,IAAID,kBAAkB;QACpBM,iBAAiBC,IAAI,CACnBC,QAAQC,GAAG,CAACC,QAAQ,KAAK,gBAErB,GAAGT,aAAaU,OAAO,CAAC,UAAU,IAAI,cAAc,CAAC,GAErD,GAAGV,aAAa,kBAAkB,CAAC;QAEzC,4BAA4B;QAC5BK,iBAAiBM,IAAI,CAAC,CAACC,GAAGC,IAAMD,EAAEE,MAAM,GAAGD,EAAEC,MAAM;IACrD;IAEA,OAAOT;AACT;AAEA;;;CAGC,GACD,OAAO,SAASU,gBACdC,OAAe,EACflB,OAAe,EACfC,gBAAyB;IAEzB,IAAI,CAACA,kBAAkB;QACrB,OAAO;IACT;IAEA,MAAMkB,QAAQV,QAAQC,GAAG,CAACC,QAAQ,KAAK;IACvC,IAAIQ,OAAO;QACT,kEAAkE;QAClE,OAAO;IACT;IAEA,yFAAyF;IACzF,OAAOrB,KAAKsB,IAAI,CAACF,SAASlB,SAAS,OAAO;AAC5C","ignoreList":[0]}