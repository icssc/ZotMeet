{"version":3,"file":"refresh-materialized-view.js","names":[],"sources":["../../../src/pg-core/async/refresh-materialized-view.ts"],"sourcesContent":["import { entityKind } from '~/entity.ts';\nimport type { PgQueryResultHKT, PgQueryResultKind, PreparedQueryConfig } from '~/pg-core/session.ts';\nimport { QueryPromise } from '~/query-promise.ts';\nimport type { RunnableQuery } from '~/runnable-query.ts';\nimport { tracer } from '~/tracing.ts';\nimport { applyMixins, type NeonAuthToken } from '~/utils.ts';\nimport { PgRefreshMaterializedView } from '../query-builders/refresh-materialized-view.ts';\nimport type { PgAsyncPreparedQuery, PgAsyncSession } from './session.ts';\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\nexport interface PgAsyncRefreshMaterializedView<TQueryResult extends PgQueryResultHKT>\n\textends QueryPromise<PgQueryResultKind<TQueryResult, never>>\n{}\n\nexport class PgAsyncRefreshMaterializedView<TQueryResult extends PgQueryResultHKT>\n\textends PgRefreshMaterializedView<TQueryResult>\n\timplements RunnableQuery<PgQueryResultKind<TQueryResult, never>, 'pg'>\n{\n\tstatic override readonly [entityKind]: string = 'PgAsyncRefreshMaterializedView';\n\n\tdeclare protected session: PgAsyncSession;\n\n\t/** @internal */\n\t_prepare(name?: string): PgAsyncPreparedQuery<\n\t\tPreparedQueryConfig & {\n\t\t\texecute: PgQueryResultKind<TQueryResult, never>;\n\t\t}\n\t> {\n\t\treturn tracer.startActiveSpan('drizzle.prepareQuery', () => {\n\t\t\treturn this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()), undefined, name, true).setToken(\n\t\t\t\tthis.authToken,\n\t\t\t);\n\t\t});\n\t}\n\n\tprepare(name: string): PgAsyncPreparedQuery<\n\t\tPreparedQueryConfig & {\n\t\t\texecute: PgQueryResultKind<TQueryResult, never>;\n\t\t}\n\t> {\n\t\treturn this._prepare(name);\n\t}\n\n\t/** @internal */\n\tprivate authToken?: NeonAuthToken;\n\t/** @internal */\n\tsetToken(token: NeonAuthToken) {\n\t\tthis.authToken = token;\n\t\treturn this;\n\t}\n\n\texecute: ReturnType<this['prepare']>['execute'] = (placeholderValues) => {\n\t\treturn tracer.startActiveSpan('drizzle.operation', () => {\n\t\t\treturn this._prepare().execute(placeholderValues);\n\t\t});\n\t};\n}\n\napplyMixins(PgAsyncRefreshMaterializedView, [QueryPromise]);\n"],"mappings":";;;;;;;AAcA,IAAa,iCAAb,cACS,0BAET;CACC,QAA0B,cAAsB;;CAKhD,SAAS,MAIP;AACD,SAAO,OAAO,gBAAgB,8BAA8B;AAC3D,UAAO,KAAK,QAAQ,aAAa,KAAK,QAAQ,WAAW,KAAK,QAAQ,CAAC,EAAE,QAAW,MAAM,KAAK,CAAC,SAC/F,KAAK,UACL;IACA;;CAGH,QAAQ,MAIN;AACD,SAAO,KAAK,SAAS,KAAK;;;CAI3B,AAAQ;;CAER,SAAS,OAAsB;AAC9B,OAAK,YAAY;AACjB,SAAO;;CAGR,WAAmD,sBAAsB;AACxE,SAAO,OAAO,gBAAgB,2BAA2B;AACxD,UAAO,KAAK,UAAU,CAAC,QAAQ,kBAAkB;IAChD;;;AAIJ,YAAY,gCAAgC,CAAC,aAAa,CAAC"}