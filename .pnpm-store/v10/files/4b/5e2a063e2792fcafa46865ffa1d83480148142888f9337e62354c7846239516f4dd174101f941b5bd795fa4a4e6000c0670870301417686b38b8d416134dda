const require_chunk = require('./chunk-CdAKIUsw.js');

//#region src/ext/api-mysql.ts
const startStudioServer = async (imports, credentials, options) => {
	const { is } = require("drizzle-orm");
	const { MySqlTable, getTableConfig } = require("drizzle-orm/mysql-core");
	const { Relations } = require("drizzle-orm/_relations");
	const { drizzleForMySQL, prepareServer } = await Promise.resolve().then(() => require("./studio-CkbYOAmM.js"));
	const mysqlSchema = {};
	const relations = {};
	Object.entries(imports).forEach(([k, t]) => {
		if (is(t, MySqlTable)) {
			const schema = getTableConfig(t).schema || "public";
			mysqlSchema[schema] = mysqlSchema[schema] || {};
			mysqlSchema[schema][k] = t;
		}
		if (is(t, Relations)) relations[k] = t;
	});
	const server = await prepareServer(await drizzleForMySQL(credentials, mysqlSchema, relations, [], options?.casing));
	const host = options?.host || "127.0.0.1";
	const port = options?.port || 4983;
	server.start({
		host,
		port,
		key: options?.key,
		cert: options?.cert,
		cb: (err) => {
			if (err) console.error(err);
			else console.log(`Studio is running at ${options?.key ? "https" : "http"}://${host}:${port}`);
		}
	});
};

//#endregion
exports.startStudioServer = startStudioServer;