{"version":3,"file":"date.common.cjs","names":["MySqlColumnBuilder","entityKind","MySqlColumn"],"sources":["../../../src/mysql-core/columns/date.common.ts"],"sourcesContent":["import type { ColumnBuilderBaseConfig, ColumnBuilderExtraConfig, ColumnType, HasDefault } from '~/column-builder.ts';\nimport type { ColumnBaseConfig } from '~/column.ts';\nimport { entityKind } from '~/entity.ts';\nimport { sql } from '~/sql/sql.ts';\nimport { MySqlColumn, MySqlColumnBuilder } from './common.ts';\nimport type { TimestampFsp } from './timestamp.ts';\n\nexport interface MySqlDateColumnBaseConfig {\n\thasOnUpdateNow: boolean;\n\tonUpdateNowFsp: TimestampFsp | undefined;\n}\n\nexport abstract class MySqlDateColumnBaseBuilder<\n\tT extends ColumnBuilderBaseConfig<ColumnType>,\n\tTRuntimeConfig extends object = object,\n\tTExtraConfig extends ColumnBuilderExtraConfig = ColumnBuilderExtraConfig,\n> extends MySqlColumnBuilder<T, TRuntimeConfig & MySqlDateColumnBaseConfig, TExtraConfig> {\n\tstatic override readonly [entityKind]: string = 'MySqlDateColumnBuilder';\n\n\tdefaultNow() {\n\t\treturn this.default(sql`(now())`);\n\t}\n\n\t// \"on update now\" also adds an implicit default value to the column - https://dev.mysql.com/doc/refman/8.0/en/timestamp-ization.html\n\tonUpdateNow(config?: { fsp: TimestampFsp }): HasDefault<this> {\n\t\tthis.config.hasOnUpdateNow = true;\n\t\tthis.config.onUpdateNowFsp = config?.fsp;\n\t\tthis.config.hasDefault = true;\n\t\treturn this as HasDefault<this>;\n\t}\n}\n\nexport abstract class MySqlDateBaseColumn<\n\tT extends ColumnBaseConfig<ColumnType>,\n\tTRuntimeConfig extends object = object,\n> extends MySqlColumn<T, MySqlDateColumnBaseConfig & TRuntimeConfig> {\n\tstatic override readonly [entityKind]: string = 'MySqlDateColumn';\n\n\treadonly hasOnUpdateNow: boolean = this.config.hasOnUpdateNow;\n\treadonly onUpdateNowFsp: TimestampFsp | undefined = this.config.onUpdateNowFsp;\n}\n"],"mappings":";;;;;;AAYA,IAAsB,6BAAtB,cAIUA,qDAAgF;CACzF,QAA0BC,0BAAsB;CAEhD,aAAa;AACZ,SAAO,KAAK,QAAQ,gBAAG,UAAU;;CAIlC,YAAY,QAAkD;AAC7D,OAAK,OAAO,iBAAiB;AAC7B,OAAK,OAAO,iBAAiB,QAAQ;AACrC,OAAK,OAAO,aAAa;AACzB,SAAO;;;AAIT,IAAsB,sBAAtB,cAGUC,8CAA2D;CACpE,QAA0BD,0BAAsB;CAEhD,AAAS,iBAA0B,KAAK,OAAO;CAC/C,AAAS,iBAA2C,KAAK,OAAO"}