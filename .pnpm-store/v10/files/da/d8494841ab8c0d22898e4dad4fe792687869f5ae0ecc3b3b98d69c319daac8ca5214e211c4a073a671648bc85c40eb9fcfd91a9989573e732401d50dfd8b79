{"version":3,"sources":["../../../src/server/mcp/get-or-create-mcp-server.ts"],"sourcesContent":["import { McpServer } from 'next/dist/compiled/@modelcontextprotocol/sdk/server/mcp'\nimport { registerGetProjectMetadataTool } from './tools/get-project-metadata'\nimport { registerGetErrorsTool } from './tools/get-errors'\nimport { registerGetPageMetadataTool } from './tools/get-page-metadata'\nimport { registerGetLogsTool } from './tools/get-logs'\nimport { registerGetActionByIdTool } from './tools/get-server-action-by-id'\nimport { registerGetRoutesTool } from './tools/get-routes'\nimport type { HmrMessageSentToBrowser } from '../dev/hot-reloader-types'\nimport type { NextConfigComplete } from '../config-shared'\n\nexport interface McpServerOptions {\n  projectPath: string\n  distDir: string\n  nextConfig: NextConfigComplete\n  pagesDir: string | undefined\n  appDir: string | undefined\n  sendHmrMessage: (message: HmrMessageSentToBrowser) => void\n  getActiveConnectionCount: () => number\n  getDevServerUrl: () => string | undefined\n}\n\nlet mcpServer: McpServer | undefined\n\nexport const getOrCreateMcpServer = (options: McpServerOptions) => {\n  if (mcpServer) {\n    return mcpServer\n  }\n\n  mcpServer = new McpServer({\n    name: 'Next.js MCP Server',\n    version: '0.2.0',\n  })\n\n  registerGetProjectMetadataTool(\n    mcpServer,\n    options.projectPath,\n    options.getDevServerUrl\n  )\n  registerGetErrorsTool(\n    mcpServer,\n    options.sendHmrMessage,\n    options.getActiveConnectionCount\n  )\n  registerGetPageMetadataTool(\n    mcpServer,\n    options.sendHmrMessage,\n    options.getActiveConnectionCount\n  )\n  registerGetLogsTool(mcpServer, options.distDir)\n  registerGetActionByIdTool(mcpServer, options.distDir)\n  registerGetRoutesTool(mcpServer, {\n    projectPath: options.projectPath,\n    nextConfig: options.nextConfig,\n    pagesDir: options.pagesDir,\n    appDir: options.appDir,\n  })\n\n  return mcpServer\n}\n"],"names":["getOrCreateMcpServer","mcpServer","options","McpServer","name","version","registerGetProjectMetadataTool","projectPath","getDevServerUrl","registerGetErrorsTool","sendHmrMessage","getActiveConnectionCount","registerGetPageMetadataTool","registerGetLogsTool","distDir","registerGetActionByIdTool","registerGetRoutesTool","nextConfig","pagesDir","appDir"],"mappings":";;;;+BAuBaA;;;eAAAA;;;qBAvBa;oCACqB;2BACT;iCACM;yBACR;qCACM;2BACJ;AAetC,IAAIC;AAEG,MAAMD,uBAAuB,CAACE;IACnC,IAAID,WAAW;QACb,OAAOA;IACT;IAEAA,YAAY,IAAIE,cAAS,CAAC;QACxBC,MAAM;QACNC,SAAS;IACX;IAEAC,IAAAA,kDAA8B,EAC5BL,WACAC,QAAQK,WAAW,EACnBL,QAAQM,eAAe;IAEzBC,IAAAA,gCAAqB,EACnBR,WACAC,QAAQQ,cAAc,EACtBR,QAAQS,wBAAwB;IAElCC,IAAAA,4CAA2B,EACzBX,WACAC,QAAQQ,cAAc,EACtBR,QAAQS,wBAAwB;IAElCE,IAAAA,4BAAmB,EAACZ,WAAWC,QAAQY,OAAO;IAC9CC,IAAAA,8CAAyB,EAACd,WAAWC,QAAQY,OAAO;IACpDE,IAAAA,gCAAqB,EAACf,WAAW;QAC/BM,aAAaL,QAAQK,WAAW;QAChCU,YAAYf,QAAQe,UAAU;QAC9BC,UAAUhB,QAAQgB,QAAQ;QAC1BC,QAAQjB,QAAQiB,MAAM;IACxB;IAEA,OAAOlB;AACT","ignoreList":[0]}