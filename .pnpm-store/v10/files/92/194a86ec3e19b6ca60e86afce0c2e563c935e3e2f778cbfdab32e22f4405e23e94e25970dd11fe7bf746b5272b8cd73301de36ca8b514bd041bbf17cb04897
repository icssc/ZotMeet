{"version":3,"file":"rls.cjs","names":[],"sources":["../../src/supabase/rls.ts"],"sourcesContent":["import { bigserial, pgSchema, text, timestamp, uuid, varchar } from '~/pg-core/index.ts';\nimport { pgRole } from '~/pg-core/roles.ts';\nimport { sql } from '~/sql/sql.ts';\n\nexport const anonRole = pgRole('anon').existing();\nexport const authenticatedRole = pgRole('authenticated').existing();\nexport const serviceRole = pgRole('service_role').existing();\nexport const postgresRole = pgRole('postgres_role').existing();\nexport const supabaseAuthAdminRole = pgRole('supabase_auth_admin').existing();\n\n/* ------------------------------ auth schema; ------------------------------ */\nconst auth = pgSchema('auth');\n\nexport const authUsers = auth.table('users', {\n\tid: uuid().primaryKey().notNull(),\n\temail: varchar({ length: 255 }),\n\tphone: text().unique(),\n\temailConfirmedAt: timestamp('email_confirmed_at', { withTimezone: true }),\n\tphoneConfirmedAt: timestamp('phone_confirmed_at', { withTimezone: true }),\n\tlastSignInAt: timestamp('last_sign_in_at', { withTimezone: true }),\n\tcreatedAt: timestamp('created_at', { withTimezone: true }),\n\tupdatedAt: timestamp('updated_at', { withTimezone: true }),\n});\n\n/* ------------------------------ realtime schema; ------------------------------- */\nconst realtime = pgSchema('realtime');\n\nexport const realtimeMessages = realtime.table(\n\t'messages',\n\t{\n\t\tid: bigserial({ mode: 'bigint' }).primaryKey(),\n\t\ttopic: text().notNull(),\n\t\textension: text({\n\t\t\tenum: ['presence', 'broadcast', 'postgres_changes'],\n\t\t}).notNull(),\n\t},\n);\n\nexport const authUid = sql`(select auth.uid())`;\nexport const realtimeTopic = sql`realtime.topic()`;\n"],"mappings":";;;;;;AAIA,MAAa,0CAAkB,OAAO,CAAC,UAAU;AACjD,MAAa,mDAA2B,gBAAgB,CAAC,UAAU;AACnE,MAAa,6CAAqB,eAAe,CAAC,UAAU;AAC5D,MAAa,8CAAsB,gBAAgB,CAAC,UAAU;AAC9D,MAAa,uDAA+B,sBAAsB,CAAC,UAAU;AAG7E,MAAM,wCAAgB,OAAO;AAE7B,MAAa,YAAY,KAAK,MAAM,SAAS;CAC5C,kCAAU,CAAC,YAAY,CAAC,SAAS;CACjC,uCAAe,EAAE,QAAQ,KAAK,CAAC;CAC/B,qCAAa,CAAC,QAAQ;CACtB,oDAA4B,sBAAsB,EAAE,cAAc,MAAM,CAAC;CACzE,oDAA4B,sBAAsB,EAAE,cAAc,MAAM,CAAC;CACzE,gDAAwB,mBAAmB,EAAE,cAAc,MAAM,CAAC;CAClE,6CAAqB,cAAc,EAAE,cAAc,MAAM,CAAC;CAC1D,6CAAqB,cAAc,EAAE,cAAc,MAAM,CAAC;CAC1D,CAAC;AAGF,MAAM,4CAAoB,WAAW;AAErC,MAAa,mBAAmB,SAAS,MACxC,YACA;CACC,sCAAc,EAAE,MAAM,UAAU,CAAC,CAAC,YAAY;CAC9C,qCAAa,CAAC,SAAS;CACvB,wCAAgB,EACf,MAAM;EAAC;EAAY;EAAa;EAAmB,EACnD,CAAC,CAAC,SAAS;CACZ,CACD;AAED,MAAa,UAAU,gBAAG;AAC1B,MAAa,gBAAgB,gBAAG"}