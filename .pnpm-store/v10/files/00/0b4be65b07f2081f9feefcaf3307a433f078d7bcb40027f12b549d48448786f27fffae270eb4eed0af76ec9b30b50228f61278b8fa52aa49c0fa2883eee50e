{"version":3,"file":"json.js","names":[],"sources":["../../../src/pg-core/columns/json.ts"],"sourcesContent":["import { entityKind } from '~/entity.ts';\nimport type { PgTable } from '~/pg-core/table.ts';\nimport { PgColumn, PgColumnBuilder } from './common.ts';\n\nexport class PgJsonBuilder extends PgColumnBuilder<\n\t{\n\t\tdataType: 'object json';\n\t\tdata: unknown;\n\t\tdriverParam: unknown;\n\t}\n> {\n\tstatic override readonly [entityKind]: string = 'PgJsonBuilder';\n\n\tconstructor(name: string) {\n\t\tsuper(name, 'object json', 'PgJson');\n\t}\n\n\t/** @internal */\n\toverride build(table: PgTable<any>) {\n\t\treturn new PgJson(table, this.config as any);\n\t}\n}\n\nexport class PgJson extends PgColumn<'object json'> {\n\tstatic override readonly [entityKind]: string = 'PgJson';\n\n\tconstructor(table: PgTable<any>, config: PgJsonBuilder['config']) {\n\t\tsuper(table, config);\n\t}\n\n\tgetSQLType(): string {\n\t\treturn 'json';\n\t}\n\n\toverride mapToDriverValue(value: unknown): string {\n\t\treturn JSON.stringify(value);\n\t}\n\n\toverride mapFromDriverValue(value: unknown): unknown {\n\t\tif (typeof value === 'string') {\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(value);\n\t\t\t} catch {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n}\n\nexport function json(name?: string): PgJsonBuilder {\n\treturn new PgJsonBuilder(name ?? '');\n}\n"],"mappings":";;;;AAIA,IAAa,gBAAb,cAAmC,gBAMjC;CACD,QAA0B,cAAsB;CAEhD,YAAY,MAAc;AACzB,QAAM,MAAM,eAAe,SAAS;;;CAIrC,AAAS,MAAM,OAAqB;AACnC,SAAO,IAAI,OAAO,OAAO,KAAK,OAAc;;;AAI9C,IAAa,SAAb,cAA4B,SAAwB;CACnD,QAA0B,cAAsB;CAEhD,YAAY,OAAqB,QAAiC;AACjE,QAAM,OAAO,OAAO;;CAGrB,aAAqB;AACpB,SAAO;;CAGR,AAAS,iBAAiB,OAAwB;AACjD,SAAO,KAAK,UAAU,MAAM;;CAG7B,AAAS,mBAAmB,OAAyB;AACpD,MAAI,OAAO,UAAU,SACpB,KAAI;AACH,UAAO,KAAK,MAAM,MAAM;UACjB;AACP,UAAO;;AAGT,SAAO;;;AAIT,SAAgB,KAAK,MAA8B;AAClD,QAAO,IAAI,cAAc,QAAQ,GAAG"}