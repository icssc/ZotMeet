{"version":3,"file":"refresh-materialized-view.cjs","names":["PgRefreshMaterializedView","entityKind","tracer"],"sources":["../../../src/pg-core/effect/refresh-materialized-view.ts"],"sourcesContent":["import { applyEffectWrapper, type QueryEffect } from '~/effect-core/query-effect.ts';\nimport { entityKind } from '~/entity.ts';\nimport type { PgQueryResultHKT, PgQueryResultKind, PreparedQueryConfig } from '~/pg-core/session.ts';\nimport type { RunnableQuery } from '~/runnable-query.ts';\nimport { tracer } from '~/tracing.ts';\nimport { PgRefreshMaterializedView } from '../query-builders/refresh-materialized-view.ts';\nimport type { PgEffectPreparedQuery, PgEffectSession } from './session.ts';\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\nexport interface PgEffectRefreshMaterializedView<TQueryResult extends PgQueryResultHKT>\n\textends QueryEffect<PgQueryResultKind<TQueryResult, never>>\n{}\n\nexport class PgEffectRefreshMaterializedView<TQueryResult extends PgQueryResultHKT>\n\textends PgRefreshMaterializedView<TQueryResult>\n\timplements RunnableQuery<PgQueryResultKind<TQueryResult, never>, 'pg'>\n{\n\tstatic override readonly [entityKind]: string = 'PgEffectRefreshMaterializedView';\n\n\tdeclare protected session: PgEffectSession;\n\n\t/** @internal */\n\t_prepare(name?: string): PgEffectPreparedQuery<\n\t\tPreparedQueryConfig & {\n\t\t\texecute: PgQueryResultKind<TQueryResult, never>;\n\t\t}\n\t> {\n\t\treturn tracer.startActiveSpan('drizzle.prepareQuery', () => {\n\t\t\treturn this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()), undefined, name, true);\n\t\t});\n\t}\n\n\tprepare(name: string): PgEffectPreparedQuery<\n\t\tPreparedQueryConfig & {\n\t\t\texecute: PgQueryResultKind<TQueryResult, never>;\n\t\t}\n\t> {\n\t\treturn this._prepare(name);\n\t}\n\n\texecute: ReturnType<this['prepare']>['execute'] = (placeholderValues) => {\n\t\treturn tracer.startActiveSpan('drizzle.operation', () => {\n\t\t\treturn this._prepare().execute(placeholderValues);\n\t\t});\n\t};\n}\n\napplyEffectWrapper(PgEffectRefreshMaterializedView);\n"],"mappings":";;;;;;;AAaA,IAAa,kCAAb,cACSA,mFAET;CACC,QAA0BC,0BAAsB;;CAKhD,SAAS,MAIP;AACD,SAAOC,oBAAO,gBAAgB,8BAA8B;AAC3D,UAAO,KAAK,QAAQ,aAAa,KAAK,QAAQ,WAAW,KAAK,QAAQ,CAAC,EAAE,QAAW,MAAM,KAAK;IAC9F;;CAGH,QAAQ,MAIN;AACD,SAAO,KAAK,SAAS,KAAK;;CAG3B,WAAmD,sBAAsB;AACxE,SAAOA,oBAAO,gBAAgB,2BAA2B;AACxD,UAAO,KAAK,UAAU,CAAC,QAAQ,kBAAkB;IAChD;;;sDAIe,gCAAgC"}