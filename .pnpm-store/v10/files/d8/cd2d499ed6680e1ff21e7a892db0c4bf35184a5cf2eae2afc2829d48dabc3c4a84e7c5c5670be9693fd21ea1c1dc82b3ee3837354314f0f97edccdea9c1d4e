{"version":3,"file":"numeric.cjs","names":["PgColumnBuilder","entityKind","PgColumn"],"sources":["../../../src/pg-core/columns/numeric.ts"],"sourcesContent":["import { entityKind } from '~/entity.ts';\nimport type { PgTable } from '~/pg-core/table.ts';\nimport { type Equal, getColumnNameAndConfig } from '~/utils.ts';\nimport { PgColumn, PgColumnBuilder } from './common.ts';\n\nexport class PgNumericBuilder extends PgColumnBuilder<\n\t{\n\t\tdataType: 'string numeric';\n\t\tdata: string;\n\t\tdriverParam: string;\n\t},\n\t{\n\t\tprecision: number | undefined;\n\t\tscale: number | undefined;\n\t}\n> {\n\tstatic override readonly [entityKind]: string = 'PgNumericBuilder';\n\n\tconstructor(name: string, precision?: number, scale?: number) {\n\t\tsuper(name, 'string numeric', 'PgNumeric');\n\t\tthis.config.precision = precision;\n\t\tthis.config.scale = scale;\n\t}\n\n\t/** @internal */\n\toverride build(table: PgTable<any>) {\n\t\treturn new PgNumeric(table, this.config as any);\n\t}\n}\n\nexport class PgNumeric extends PgColumn<'string numeric'> {\n\tstatic override readonly [entityKind]: string = 'PgNumeric';\n\n\treadonly precision: number | undefined;\n\treadonly scale: number | undefined;\n\n\tconstructor(table: PgTable<any>, config: PgNumericBuilder['config']) {\n\t\tsuper(table, config);\n\t\tthis.precision = config.precision;\n\t\tthis.scale = config.scale;\n\t}\n\n\toverride mapFromDriverValue(value: unknown): string {\n\t\tif (typeof value === 'string') return value;\n\n\t\treturn String(value);\n\t}\n\n\tgetSQLType(): string {\n\t\tif (this.precision !== undefined && this.scale !== undefined) {\n\t\t\treturn `numeric(${this.precision}, ${this.scale})`;\n\t\t} else if (this.precision === undefined) {\n\t\t\treturn 'numeric';\n\t\t} else {\n\t\t\treturn `numeric(${this.precision})`;\n\t\t}\n\t}\n}\n\nexport class PgNumericNumberBuilder extends PgColumnBuilder<\n\t{\n\t\tdataType: 'number';\n\t\tdata: number;\n\t\tdriverParam: string;\n\t},\n\t{\n\t\tprecision: number | undefined;\n\t\tscale: number | undefined;\n\t}\n> {\n\tstatic override readonly [entityKind]: string = 'PgNumericNumberBuilder';\n\n\tconstructor(name: string, precision?: number, scale?: number) {\n\t\tsuper(name, 'number', 'PgNumericNumber');\n\t\tthis.config.precision = precision;\n\t\tthis.config.scale = scale;\n\t}\n\n\t/** @internal */\n\toverride build(table: PgTable<any>) {\n\t\treturn new PgNumericNumber(\n\t\t\ttable,\n\t\t\tthis.config as any,\n\t\t);\n\t}\n}\n\nexport class PgNumericNumber extends PgColumn<'number'> {\n\tstatic override readonly [entityKind]: string = 'PgNumericNumber';\n\n\treadonly precision: number | undefined;\n\treadonly scale: number | undefined;\n\n\tconstructor(table: PgTable<any>, config: PgNumericNumberBuilder['config']) {\n\t\tsuper(table, config);\n\t\tthis.precision = config.precision;\n\t\tthis.scale = config.scale;\n\t}\n\n\toverride mapFromDriverValue(value: unknown): number {\n\t\tif (typeof value === 'number') return value;\n\n\t\treturn Number(value);\n\t}\n\n\toverride mapToDriverValue(value: number): string {\n\t\treturn String(value);\n\t}\n\n\tgetSQLType(): string {\n\t\tif (this.precision !== undefined && this.scale !== undefined) {\n\t\t\treturn `numeric(${this.precision}, ${this.scale})`;\n\t\t} else if (this.precision === undefined) {\n\t\t\treturn 'numeric';\n\t\t} else {\n\t\t\treturn `numeric(${this.precision})`;\n\t\t}\n\t}\n}\n\nexport class PgNumericBigIntBuilder extends PgColumnBuilder<\n\t{\n\t\tdataType: 'bigint int64';\n\t\tdata: bigint;\n\t\tdriverParam: string;\n\t},\n\t{\n\t\tprecision: number | undefined;\n\t\tscale: number | undefined;\n\t}\n> {\n\tstatic override readonly [entityKind]: string = 'PgNumericBigIntBuilder';\n\n\tconstructor(name: string, precision?: number, scale?: number) {\n\t\tsuper(name, 'bigint int64', 'PgNumericBigInt');\n\t\tthis.config.precision = precision;\n\t\tthis.config.scale = scale;\n\t}\n\n\t/** @internal */\n\toverride build(table: PgTable<any>) {\n\t\treturn new PgNumericBigInt(\n\t\t\ttable,\n\t\t\tthis.config as any,\n\t\t);\n\t}\n}\n\nexport class PgNumericBigInt extends PgColumn<'bigint int64'> {\n\tstatic override readonly [entityKind]: string = 'PgNumericBigInt';\n\n\treadonly precision: number | undefined;\n\treadonly scale: number | undefined;\n\n\tconstructor(table: PgTable<any>, config: PgNumericBigIntBuilder['config']) {\n\t\tsuper(table, config);\n\t\tthis.precision = config.precision;\n\t\tthis.scale = config.scale;\n\t}\n\n\toverride mapFromDriverValue(value: string | number): bigint {\n\t\treturn BigInt(value);\n\t}\n\n\toverride mapToDriverValue(value: bigint): string {\n\t\treturn String(value);\n\t}\n\n\tgetSQLType(): string {\n\t\tif (this.precision !== undefined && this.scale !== undefined) {\n\t\t\treturn `numeric(${this.precision}, ${this.scale})`;\n\t\t} else if (this.precision === undefined) {\n\t\t\treturn 'numeric';\n\t\t} else {\n\t\t\treturn `numeric(${this.precision})`;\n\t\t}\n\t}\n}\n\nexport type PgNumericConfig<T extends 'string' | 'number' | 'bigint' = 'string' | 'number' | 'bigint'> =\n\t| { precision: number; scale?: number; mode?: T }\n\t| { precision?: number; scale: number; mode?: T }\n\t| { precision?: number; scale?: number; mode: T };\n\nexport function numeric<TMode extends 'string' | 'number' | 'bigint'>(\n\tconfig?: PgNumericConfig<TMode>,\n): Equal<TMode, 'number'> extends true ? PgNumericNumberBuilder\n\t: Equal<TMode, 'bigint'> extends true ? PgNumericBigIntBuilder\n\t: PgNumericBuilder;\nexport function numeric<TMode extends 'string' | 'number' | 'bigint'>(\n\tname: string,\n\tconfig?: PgNumericConfig<TMode>,\n): Equal<TMode, 'number'> extends true ? PgNumericNumberBuilder\n\t: Equal<TMode, 'bigint'> extends true ? PgNumericBigIntBuilder\n\t: PgNumericBuilder;\nexport function numeric(a?: string | PgNumericConfig, b?: PgNumericConfig) {\n\tconst { name, config } = getColumnNameAndConfig<PgNumericConfig>(a, b);\n\tconst mode = config?.mode;\n\treturn mode === 'number'\n\t\t? new PgNumericNumberBuilder(name, config?.precision, config?.scale)\n\t\t: mode === 'bigint'\n\t\t? new PgNumericBigIntBuilder(name, config?.precision, config?.scale)\n\t\t: new PgNumericBuilder(name, config?.precision, config?.scale);\n}\n\nexport const decimal = numeric;\n"],"mappings":";;;;;;AAKA,IAAa,mBAAb,cAAsCA,+CAUpC;CACD,QAA0BC,0BAAsB;CAEhD,YAAY,MAAc,WAAoB,OAAgB;AAC7D,QAAM,MAAM,kBAAkB,YAAY;AAC1C,OAAK,OAAO,YAAY;AACxB,OAAK,OAAO,QAAQ;;;CAIrB,AAAS,MAAM,OAAqB;AACnC,SAAO,IAAI,UAAU,OAAO,KAAK,OAAc;;;AAIjD,IAAa,YAAb,cAA+BC,wCAA2B;CACzD,QAA0BD,0BAAsB;CAEhD,AAAS;CACT,AAAS;CAET,YAAY,OAAqB,QAAoC;AACpE,QAAM,OAAO,OAAO;AACpB,OAAK,YAAY,OAAO;AACxB,OAAK,QAAQ,OAAO;;CAGrB,AAAS,mBAAmB,OAAwB;AACnD,MAAI,OAAO,UAAU,SAAU,QAAO;AAEtC,SAAO,OAAO,MAAM;;CAGrB,aAAqB;AACpB,MAAI,KAAK,cAAc,UAAa,KAAK,UAAU,OAClD,QAAO,WAAW,KAAK,UAAU,IAAI,KAAK,MAAM;WACtC,KAAK,cAAc,OAC7B,QAAO;MAEP,QAAO,WAAW,KAAK,UAAU;;;AAKpC,IAAa,yBAAb,cAA4CD,+CAU1C;CACD,QAA0BC,0BAAsB;CAEhD,YAAY,MAAc,WAAoB,OAAgB;AAC7D,QAAM,MAAM,UAAU,kBAAkB;AACxC,OAAK,OAAO,YAAY;AACxB,OAAK,OAAO,QAAQ;;;CAIrB,AAAS,MAAM,OAAqB;AACnC,SAAO,IAAI,gBACV,OACA,KAAK,OACL;;;AAIH,IAAa,kBAAb,cAAqCC,wCAAmB;CACvD,QAA0BD,0BAAsB;CAEhD,AAAS;CACT,AAAS;CAET,YAAY,OAAqB,QAA0C;AAC1E,QAAM,OAAO,OAAO;AACpB,OAAK,YAAY,OAAO;AACxB,OAAK,QAAQ,OAAO;;CAGrB,AAAS,mBAAmB,OAAwB;AACnD,MAAI,OAAO,UAAU,SAAU,QAAO;AAEtC,SAAO,OAAO,MAAM;;CAGrB,AAAS,iBAAiB,OAAuB;AAChD,SAAO,OAAO,MAAM;;CAGrB,aAAqB;AACpB,MAAI,KAAK,cAAc,UAAa,KAAK,UAAU,OAClD,QAAO,WAAW,KAAK,UAAU,IAAI,KAAK,MAAM;WACtC,KAAK,cAAc,OAC7B,QAAO;MAEP,QAAO,WAAW,KAAK,UAAU;;;AAKpC,IAAa,yBAAb,cAA4CD,+CAU1C;CACD,QAA0BC,0BAAsB;CAEhD,YAAY,MAAc,WAAoB,OAAgB;AAC7D,QAAM,MAAM,gBAAgB,kBAAkB;AAC9C,OAAK,OAAO,YAAY;AACxB,OAAK,OAAO,QAAQ;;;CAIrB,AAAS,MAAM,OAAqB;AACnC,SAAO,IAAI,gBACV,OACA,KAAK,OACL;;;AAIH,IAAa,kBAAb,cAAqCC,wCAAyB;CAC7D,QAA0BD,0BAAsB;CAEhD,AAAS;CACT,AAAS;CAET,YAAY,OAAqB,QAA0C;AAC1E,QAAM,OAAO,OAAO;AACpB,OAAK,YAAY,OAAO;AACxB,OAAK,QAAQ,OAAO;;CAGrB,AAAS,mBAAmB,OAAgC;AAC3D,SAAO,OAAO,MAAM;;CAGrB,AAAS,iBAAiB,OAAuB;AAChD,SAAO,OAAO,MAAM;;CAGrB,aAAqB;AACpB,MAAI,KAAK,cAAc,UAAa,KAAK,UAAU,OAClD,QAAO,WAAW,KAAK,UAAU,IAAI,KAAK,MAAM;WACtC,KAAK,cAAc,OAC7B,QAAO;MAEP,QAAO,WAAW,KAAK,UAAU;;;AAqBpC,SAAgB,QAAQ,GAA8B,GAAqB;CAC1E,MAAM,EAAE,MAAM,kDAAmD,GAAG,EAAE;CACtE,MAAM,OAAO,QAAQ;AACrB,QAAO,SAAS,WACb,IAAI,uBAAuB,MAAM,QAAQ,WAAW,QAAQ,MAAM,GAClE,SAAS,WACT,IAAI,uBAAuB,MAAM,QAAQ,WAAW,QAAQ,MAAM,GAClE,IAAI,iBAAiB,MAAM,QAAQ,WAAW,QAAQ,MAAM;;AAGhE,MAAa,UAAU"}