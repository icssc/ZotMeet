{"version":3,"sources":["../../src/build/entries.ts"],"sourcesContent":["import type { ClientPagesLoaderOptions } from './webpack/loaders/next-client-pages-loader'\nimport type { MiddlewareLoaderOptions } from './webpack/loaders/next-middleware-loader'\nimport type { EdgeSSRLoaderQuery } from './webpack/loaders/next-edge-ssr-loader'\nimport type { EdgeAppRouteLoaderQuery } from './webpack/loaders/next-edge-app-route-loader'\nimport type { NextConfigComplete } from '../server/config-shared'\nimport type { webpack } from 'next/dist/compiled/webpack/webpack'\nimport type {\n  ProxyConfig,\n  ProxyMatcher,\n  PageStaticInfo,\n} from './analysis/get-page-static-info'\nimport type { LoadedEnvFiles } from '@next/env'\nimport type { AppLoaderOptions } from './webpack/loaders/next-app-loader'\n\nimport { posix, join, normalize } from 'path'\nimport { stringify } from 'querystring'\nimport {\n  PAGES_DIR_ALIAS,\n  ROOT_DIR_ALIAS,\n  APP_DIR_ALIAS,\n  WEBPACK_LAYERS,\n  INSTRUMENTATION_HOOK_FILENAME,\n} from '../lib/constants'\nimport { isAPIRoute } from '../lib/is-api-route'\nimport { isEdgeRuntime } from '../lib/is-edge-runtime'\nimport {\n  APP_CLIENT_INTERNALS,\n  RSC_MODULE_TYPES,\n  UNDERSCORE_NOT_FOUND_ROUTE,\n} from '../shared/lib/constants'\nimport {\n  CLIENT_STATIC_FILES_RUNTIME_MAIN,\n  CLIENT_STATIC_FILES_RUNTIME_MAIN_APP,\n  CLIENT_STATIC_FILES_RUNTIME_POLYFILLS,\n  CLIENT_STATIC_FILES_RUNTIME_REACT_REFRESH,\n  COMPILER_NAMES,\n  EDGE_RUNTIME_WEBPACK,\n} from '../shared/lib/constants'\nimport type { CompilerNameValues } from '../shared/lib/constants'\nimport type { __ApiPreviewProps } from '../server/api-utils'\nimport {\n  isMiddlewareFile,\n  isMiddlewareFilename,\n  isProxyFile,\n  isInstrumentationHookFile,\n  isInstrumentationHookFilename,\n} from './utils'\nimport { getPageStaticInfo } from './analysis/get-page-static-info'\nimport { normalizePathSep } from '../shared/lib/page-path/normalize-path-sep'\nimport { normalizePagePath } from '../shared/lib/page-path/normalize-page-path'\nimport type { ServerRuntime } from '../types'\nimport { normalizeAppPath } from '../shared/lib/router/utils/app-paths'\nimport { encodeMatchers } from './webpack/loaders/next-middleware-loader'\nimport type { EdgeFunctionLoaderOptions } from './webpack/loaders/next-edge-function-loader'\nimport { isAppRouteRoute } from '../lib/is-app-route-route'\nimport {\n  normalizeMetadataPageToRoute,\n  normalizeMetadataRoute,\n} from '../lib/metadata/get-metadata-route'\nimport { getRouteLoaderEntry } from './webpack/loaders/next-route-loader'\nimport {\n  isInternalComponent,\n  isNonRoutePagesPage,\n} from '../lib/is-internal-component'\nimport { isMetadataRouteFile } from '../lib/metadata/is-metadata-route'\nimport { RouteKind } from '../server/route-kind'\nimport { encodeToBase64 } from './webpack/loaders/utils'\nimport { normalizeCatchAllRoutes } from './normalize-catchall-routes'\nimport type { PageExtensions } from './page-extensions-type'\nimport type { MappedPages } from './build-context'\nimport { PAGE_TYPES } from '../lib/page-types'\nimport { recursiveReadDir } from '../lib/recursive-readdir'\nimport type { createValidFileMatcher } from '../server/lib/find-page-file'\nimport { isReservedPage } from './utils'\nimport { isParallelRouteSegment } from '../shared/lib/segment'\nimport { ensureLeadingSlash } from '../shared/lib/page-path/ensure-leading-slash'\nimport {\n  UNDERSCORE_NOT_FOUND_ROUTE_ENTRY,\n  UNDERSCORE_GLOBAL_ERROR_ROUTE,\n  UNDERSCORE_GLOBAL_ERROR_ROUTE_ENTRY,\n} from '../shared/lib/entry-constants'\nimport { getStaticInfoIncludingLayouts } from './get-static-info-including-layouts'\n\n/**\n * Collect app pages, layouts, and default files from the app directory\n * @param appDir - The app directory path\n * @param validFileMatcher - File matcher object\n * @returns Object containing appPaths, layoutPaths, and defaultPaths arrays\n */\nexport async function collectAppFiles(\n  appDir: string,\n  validFileMatcher: ReturnType<typeof createValidFileMatcher>\n): Promise<{\n  appPaths: string[]\n  layoutPaths: string[]\n  defaultPaths: string[]\n}> {\n  // Collect app pages, layouts, and default files in a single directory traversal\n  const allAppFiles = await recursiveReadDir(appDir, {\n    pathnameFilter: (absolutePath) =>\n      validFileMatcher.isAppRouterPage(absolutePath) ||\n      validFileMatcher.isRootNotFound(absolutePath) ||\n      validFileMatcher.isAppLayoutPage(absolutePath) ||\n      validFileMatcher.isAppDefaultPage(absolutePath),\n    ignorePartFilter: (part) => part.startsWith('_'),\n  })\n\n  // Separate app pages, layouts, and defaults\n  const appPaths = allAppFiles.filter(\n    (absolutePath) =>\n      validFileMatcher.isAppRouterPage(absolutePath) ||\n      validFileMatcher.isRootNotFound(absolutePath)\n  )\n  const layoutPaths = allAppFiles.filter((absolutePath) =>\n    validFileMatcher.isAppLayoutPage(absolutePath)\n  )\n  const defaultPaths = allAppFiles.filter((absolutePath) =>\n    validFileMatcher.isAppDefaultPage(absolutePath)\n  )\n\n  return { appPaths, layoutPaths, defaultPaths }\n}\n\n/**\n * Collect pages from the pages directory\n * @param pagesDir - The pages directory path\n * @param validFileMatcher - File matcher object\n * @returns Array of page file paths\n */\nexport async function collectPagesFiles(\n  pagesDir: string,\n  validFileMatcher: ReturnType<typeof createValidFileMatcher>\n): Promise<string[]> {\n  return recursiveReadDir(pagesDir, {\n    pathnameFilter: validFileMatcher.isPageFile,\n  })\n}\n\n// Types for route processing\nexport type RouteInfo = {\n  route: string\n  filePath: string\n}\n\nexport type SlotInfo = {\n  name: string\n  parent: string\n}\n\n/**\n * Create a relative file path from a mapped page path\n * @param baseDir - The base directory path\n * @param filePath - The mapped file path (with private prefix)\n * @param prefix - The directory prefix ('pages' or 'app')\n * @param isSrcDir - Whether the project uses src directory structure\n * @returns The relative file path\n */\nexport function createRelativeFilePath(\n  baseDir: string,\n  filePath: string,\n  prefix: 'pages' | 'app',\n  isSrcDir: boolean\n): string {\n  const privatePrefix =\n    prefix === 'pages' ? 'private-next-pages' : 'private-next-app-dir'\n  const srcPrefix = isSrcDir ? 'src/' : ''\n  return join(\n    baseDir,\n    filePath.replace(new RegExp(`^${privatePrefix}/`), `${srcPrefix}${prefix}/`)\n  )\n}\n\n/**\n * Process pages routes from mapped pages\n * @param mappedPages - The mapped pages object\n * @param baseDir - The base directory path\n * @param isSrcDir - Whether the project uses src directory structure\n * @returns Object containing pageRoutes and pageApiRoutes\n */\nexport function processPageRoutes(\n  mappedPages: { [page: string]: string },\n  baseDir: string,\n  isSrcDir: boolean\n): {\n  pageRoutes: RouteInfo[]\n  pageApiRoutes: RouteInfo[]\n} {\n  const pageRoutes: RouteInfo[] = []\n  const pageApiRoutes: RouteInfo[] = []\n\n  for (const [route, filePath] of Object.entries(mappedPages)) {\n    const relativeFilePath = createRelativeFilePath(\n      baseDir,\n      filePath,\n      'pages',\n      isSrcDir\n    )\n\n    if (route.startsWith('/api/')) {\n      pageApiRoutes.push({\n        route: normalizePathSep(route),\n        filePath: relativeFilePath,\n      })\n    } else {\n      // Filter out _app, _error, _document\n      if (isReservedPage(route)) continue\n\n      pageRoutes.push({\n        route: normalizePathSep(route),\n        filePath: relativeFilePath,\n      })\n    }\n  }\n\n  return { pageRoutes, pageApiRoutes }\n}\n\n/**\n * Extract slots from app routes\n * @param mappedAppPages - The mapped app pages object\n * @returns Array of slot information\n */\nexport function extractSlotsFromAppRoutes(mappedAppPages: {\n  [page: string]: string\n}): SlotInfo[] {\n  const slots: SlotInfo[] = []\n\n  for (const [page] of Object.entries(mappedAppPages)) {\n    if (\n      page === UNDERSCORE_NOT_FOUND_ROUTE_ENTRY ||\n      page === UNDERSCORE_GLOBAL_ERROR_ROUTE_ENTRY\n    ) {\n      continue\n    }\n\n    const segments = page.split('/')\n    for (let i = segments.length - 1; i >= 0; i--) {\n      const segment = segments[i]\n      if (isParallelRouteSegment(segment)) {\n        const parentPath = normalizeAppPath(segments.slice(0, i).join('/'))\n        const slotName = segment.slice(1)\n\n        // Check if the slot already exists\n        if (slots.some((s) => s.name === slotName && s.parent === parentPath))\n          continue\n\n        slots.push({\n          name: slotName,\n          parent: parentPath,\n        })\n        break\n      }\n    }\n  }\n\n  return slots\n}\n\n/**\n * Extract slots from default files\n * @param mappedDefaultFiles - The mapped default files object\n * @returns Array of slot information\n */\nexport function extractSlotsFromDefaultFiles(mappedDefaultFiles: {\n  [page: string]: string\n}): SlotInfo[] {\n  const slots: SlotInfo[] = []\n\n  for (const [route] of Object.entries(mappedDefaultFiles)) {\n    const segments = route.split('/')\n    for (let i = segments.length - 1; i >= 0; i--) {\n      const segment = segments[i]\n      if (isParallelRouteSegment(segment)) {\n        const parentPath = normalizeAppPath(segments.slice(0, i).join('/'))\n        const slotName = segment.slice(1)\n\n        // Check if the slot already exists\n        if (slots.some((s) => s.name === slotName && s.parent === parentPath))\n          continue\n\n        slots.push({\n          name: slotName,\n          parent: parentPath,\n        })\n        break\n      }\n    }\n  }\n\n  return slots\n}\n\n/**\n * Combine and deduplicate slot arrays using a Set\n * @param slotArrays - Arrays of slot information to combine\n * @returns Deduplicated array of slots\n */\nexport function combineSlots(...slotArrays: SlotInfo[][]): SlotInfo[] {\n  const slotSet = new Set<string>()\n  const result: SlotInfo[] = []\n\n  for (const slots of slotArrays) {\n    for (const slot of slots) {\n      const key = `${slot.name}:${slot.parent}`\n      if (!slotSet.has(key)) {\n        slotSet.add(key)\n        result.push(slot)\n      }\n    }\n  }\n\n  return result\n}\n\n/**\n * Process app routes from mapped app pages\n * @param mappedAppPages - The mapped app pages object\n * @param validFileMatcher - File matcher object\n * @param baseDir - The base directory path\n * @param isSrcDir - Whether the project uses src directory structure\n * @returns Array of route information\n */\nexport function processAppRoutes(\n  mappedAppPages: { [page: string]: string },\n  validFileMatcher: ReturnType<typeof createValidFileMatcher>,\n  baseDir: string,\n  isSrcDir: boolean\n): {\n  appRoutes: RouteInfo[]\n  appRouteHandlers: RouteInfo[]\n} {\n  const appRoutes: RouteInfo[] = []\n  const appRouteHandlers: RouteInfo[] = []\n\n  for (const [page, filePath] of Object.entries(mappedAppPages)) {\n    if (\n      page === UNDERSCORE_NOT_FOUND_ROUTE_ENTRY ||\n      page === UNDERSCORE_GLOBAL_ERROR_ROUTE_ENTRY\n    ) {\n      continue\n    }\n\n    const relativeFilePath = createRelativeFilePath(\n      baseDir,\n      filePath,\n      'app',\n      isSrcDir\n    )\n\n    if (validFileMatcher.isAppRouterRoute(filePath)) {\n      appRouteHandlers.push({\n        route: normalizeAppPath(normalizePathSep(page)),\n        filePath: relativeFilePath,\n      })\n    } else {\n      appRoutes.push({\n        route: normalizeAppPath(normalizePathSep(page)),\n        filePath: relativeFilePath,\n      })\n    }\n  }\n\n  return { appRoutes, appRouteHandlers }\n}\n\n/**\n * Process layout routes from mapped app layouts\n * @param mappedAppLayouts - The mapped app layouts object\n * @param baseDir - The base directory path\n * @param isSrcDir - Whether the project uses src directory structure\n * @returns Array of layout route information\n */\nexport function processLayoutRoutes(\n  mappedAppLayouts: { [page: string]: string },\n  baseDir: string,\n  isSrcDir: boolean\n): RouteInfo[] {\n  const layoutRoutes: RouteInfo[] = []\n\n  for (const [route, filePath] of Object.entries(mappedAppLayouts)) {\n    const relativeFilePath = createRelativeFilePath(\n      baseDir,\n      filePath,\n      'app',\n      isSrcDir\n    )\n    layoutRoutes.push({\n      route: ensureLeadingSlash(\n        normalizeAppPath(normalizePathSep(route)).replace(/\\/layout$/, '')\n      ),\n      filePath: relativeFilePath,\n    })\n  }\n\n  return layoutRoutes\n}\n\ntype ObjectValue<T> = T extends { [key: string]: infer V } ? V : never\n\n/**\n * For a given page path removes the provided extensions.\n */\nexport function getPageFromPath(\n  pagePath: string,\n  pageExtensions: PageExtensions\n) {\n  let page = normalizePathSep(\n    pagePath.replace(new RegExp(`\\\\.+(${pageExtensions.join('|')})$`), '')\n  )\n\n  page = page.replace(/\\/index$/, '')\n\n  return page === '' ? '/' : page\n}\n\nexport function getPageFilePath({\n  absolutePagePath,\n  pagesDir,\n  appDir,\n  rootDir,\n}: {\n  absolutePagePath: string\n  pagesDir: string | undefined\n  appDir: string | undefined\n  rootDir: string\n}) {\n  if (absolutePagePath.startsWith(PAGES_DIR_ALIAS) && pagesDir) {\n    return absolutePagePath.replace(PAGES_DIR_ALIAS, pagesDir)\n  }\n\n  if (absolutePagePath.startsWith(APP_DIR_ALIAS) && appDir) {\n    return absolutePagePath.replace(APP_DIR_ALIAS, appDir)\n  }\n\n  if (absolutePagePath.startsWith(ROOT_DIR_ALIAS)) {\n    return absolutePagePath.replace(ROOT_DIR_ALIAS, rootDir)\n  }\n\n  return require.resolve(absolutePagePath)\n}\n\n/**\n * Creates a mapping of route to page file path for a given list of page paths.\n * For example ['/middleware.ts'] is turned into  { '/middleware': `${ROOT_DIR_ALIAS}/middleware.ts` }\n */\nexport async function createPagesMapping({\n  isDev,\n  pageExtensions,\n  pagePaths,\n  pagesType,\n  pagesDir,\n  appDir,\n  appDirOnly,\n}: {\n  isDev: boolean\n  pageExtensions: PageExtensions\n  pagePaths: string[]\n  pagesType: PAGE_TYPES\n  pagesDir: string | undefined\n  appDir: string | undefined\n  appDirOnly: boolean\n}): Promise<MappedPages> {\n  const isAppRoute = pagesType === 'app'\n\n  const promises = pagePaths.map<Promise<[string, string] | undefined>>(\n    async (pagePath) => {\n      // Do not process .d.ts files as routes\n      if (pagePath.endsWith('.d.ts') && pageExtensions.includes('ts')) {\n        return\n      }\n\n      let pageKey = getPageFromPath(pagePath, pageExtensions)\n      if (isAppRoute) {\n        pageKey = pageKey.replace(/%5F/g, '_')\n        if (pageKey === UNDERSCORE_NOT_FOUND_ROUTE) {\n          pageKey = UNDERSCORE_NOT_FOUND_ROUTE_ENTRY\n        }\n        if (pageKey === UNDERSCORE_GLOBAL_ERROR_ROUTE) {\n          pageKey = UNDERSCORE_GLOBAL_ERROR_ROUTE_ENTRY\n        }\n      }\n\n      const normalizedPath = normalizePathSep(\n        join(\n          pagesType === 'pages'\n            ? PAGES_DIR_ALIAS\n            : pagesType === 'app'\n              ? APP_DIR_ALIAS\n              : ROOT_DIR_ALIAS,\n          pagePath\n        )\n      )\n\n      let route =\n        pagesType === 'app' ? normalizeMetadataRoute(pageKey) : pageKey\n\n      if (\n        pagesType === 'app' &&\n        isMetadataRouteFile(pagePath, pageExtensions, true)\n      ) {\n        const filePath = join(appDir!, pagePath)\n        const staticInfo = await getPageStaticInfo({\n          nextConfig: {},\n          pageFilePath: filePath,\n          isDev,\n          page: pageKey,\n          pageType: pagesType,\n        })\n\n        route = normalizeMetadataPageToRoute(\n          route,\n          !!(staticInfo.generateImageMetadata || staticInfo.generateSitemaps)\n        )\n      }\n\n      return [route, normalizedPath]\n    }\n  )\n\n  const pages: MappedPages = Object.fromEntries(\n    (await Promise.all(promises)).filter((entry) => entry != null)\n  )\n\n  switch (pagesType) {\n    case PAGE_TYPES.ROOT: {\n      return pages\n    }\n    case PAGE_TYPES.APP: {\n      const hasAppPages = Object.keys(pages).length > 0\n      // Whether to emit App router 500.html entry, which only presents in production and only app router presents\n      const hasAppGlobalError = !isDev && appDirOnly\n      return {\n        // If there's any app pages existed, add a default /_not-found route as 404.\n        // If there's any custom /_not-found page, it will override the default one.\n        ...(hasAppPages && {\n          [UNDERSCORE_NOT_FOUND_ROUTE_ENTRY]: require.resolve(\n            'next/dist/client/components/builtin/global-not-found'\n          ),\n        }),\n        ...(hasAppGlobalError && {\n          [UNDERSCORE_GLOBAL_ERROR_ROUTE_ENTRY]: require.resolve(\n            'next/dist/client/components/builtin/app-error'\n          ),\n        }),\n        ...pages,\n      }\n    }\n    case PAGE_TYPES.PAGES: {\n      if (isDev) {\n        delete pages['/_app']\n        delete pages['/_error']\n        delete pages['/_document']\n      }\n\n      // In development we always alias these to allow Webpack to fallback to\n      // the correct source file so that HMR can work properly when a file is\n      // added or removed.\n      const root = isDev && pagesDir ? PAGES_DIR_ALIAS : 'next/dist/pages'\n\n      // If there are no user pages routes, treat this as app-dir-only mode.\n      // The pages/ folder could be present and the initial appDirOnly is treated as false, but no valid routes are found.\n      if (Object.keys(pages).length === 0 && !appDirOnly) {\n        appDirOnly = true\n      }\n\n      return {\n        // Don't add default pages entries if this is an app-router-only build\n        ...((isDev || !appDirOnly) && {\n          '/_app': `${root}/_app`,\n          '/_error': `${root}/_error`,\n          '/_document': `${root}/_document`,\n          ...pages,\n        }),\n      }\n    }\n    default: {\n      return {}\n    }\n  }\n}\n\nexport interface CreateEntrypointsParams {\n  buildId: string\n  config: NextConfigComplete\n  envFiles: LoadedEnvFiles\n  isDev: boolean\n  pages: MappedPages\n  pagesDir?: string\n  previewMode: __ApiPreviewProps\n  rootDir: string\n  rootPaths?: MappedPages\n  appDir?: string\n  appPaths?: MappedPages\n  pageExtensions: PageExtensions\n  hasInstrumentationHook?: boolean\n}\n\nexport function getEdgeServerEntry(opts: {\n  rootDir: string\n  absolutePagePath: string\n  buildId: string\n  bundlePath: string\n  config: NextConfigComplete\n  isDev: boolean\n  isServerComponent: boolean\n  page: string\n  pages: MappedPages\n  middleware?: Partial<ProxyConfig>\n  pagesType: PAGE_TYPES\n  appDirLoader?: string\n  hasInstrumentationHook?: boolean\n  preferredRegion: string | string[] | undefined\n  middlewareConfig?: ProxyConfig\n}) {\n  if (\n    opts.pagesType === 'app' &&\n    isAppRouteRoute(opts.page) &&\n    opts.appDirLoader\n  ) {\n    const loaderParams: EdgeAppRouteLoaderQuery = {\n      absolutePagePath: opts.absolutePagePath,\n      page: opts.page,\n      appDirLoader: Buffer.from(opts.appDirLoader || '').toString('base64'),\n      preferredRegion: opts.preferredRegion,\n      middlewareConfig: Buffer.from(\n        JSON.stringify(opts.middlewareConfig || {})\n      ).toString('base64'),\n      cacheHandlers: JSON.stringify(opts.config.cacheHandlers || {}),\n    }\n\n    return {\n      import: `next-edge-app-route-loader?${stringify(loaderParams)}!`,\n      layer: WEBPACK_LAYERS.reactServerComponents,\n    }\n  }\n\n  if (isMiddlewareFile(opts.page)) {\n    const loaderParams: MiddlewareLoaderOptions = {\n      absolutePagePath: opts.absolutePagePath,\n      page: opts.page,\n      rootDir: opts.rootDir,\n      matchers: opts.middleware?.matchers\n        ? encodeMatchers(opts.middleware.matchers)\n        : '',\n      preferredRegion: opts.preferredRegion,\n      middlewareConfig: Buffer.from(\n        JSON.stringify(opts.middlewareConfig || {})\n      ).toString('base64'),\n    }\n\n    return {\n      import: `next-middleware-loader?${stringify(loaderParams)}!`,\n      layer: WEBPACK_LAYERS.middleware,\n      filename: opts.isDev ? 'middleware.js' : undefined,\n    }\n  }\n\n  if (isAPIRoute(opts.page)) {\n    const loaderParams: EdgeFunctionLoaderOptions = {\n      absolutePagePath: opts.absolutePagePath,\n      page: opts.page,\n      rootDir: opts.rootDir,\n      preferredRegion: opts.preferredRegion,\n      middlewareConfig: Buffer.from(\n        JSON.stringify(opts.middlewareConfig || {})\n      ).toString('base64'),\n    }\n\n    return {\n      import: `next-edge-function-loader?${stringify(loaderParams)}!`,\n      layer: WEBPACK_LAYERS.apiEdge,\n    }\n  }\n\n  const loaderParams: EdgeSSRLoaderQuery = {\n    absolute500Path: opts.pages['/500'] || '',\n    absoluteAppPath: opts.pages['/_app'],\n    absoluteDocumentPath: opts.pages['/_document'],\n    absoluteErrorPath: opts.pages['/_error'],\n    absolutePagePath: opts.absolutePagePath,\n    dev: opts.isDev,\n    isServerComponent: opts.isServerComponent,\n    page: opts.page,\n    pagesType: opts.pagesType,\n    appDirLoader: Buffer.from(opts.appDirLoader || '').toString('base64'),\n    sriEnabled: !opts.isDev && !!opts.config.experimental.sri?.algorithm,\n    cacheHandler: opts.config.cacheHandler,\n    preferredRegion: opts.preferredRegion,\n    middlewareConfig: Buffer.from(\n      JSON.stringify(opts.middlewareConfig || {})\n    ).toString('base64'),\n    serverActions: opts.config.experimental.serverActions,\n    cacheHandlers: JSON.stringify(opts.config.cacheHandlers || {}),\n  }\n\n  return {\n    import: `next-edge-ssr-loader?${JSON.stringify(loaderParams)}!`,\n    // The Edge bundle includes the server in its entrypoint, so it has to\n    // be in the SSR layer â€” we later convert the page request to the RSC layer\n    // via a webpack rule.\n    layer: opts.appDirLoader ? WEBPACK_LAYERS.serverSideRendering : undefined,\n  }\n}\n\nexport function getInstrumentationEntry(opts: {\n  absolutePagePath: string\n  isEdgeServer: boolean\n  isDev: boolean\n}) {\n  // the '../' is needed to make sure the file is not chunked\n  const filename = `${\n    opts.isEdgeServer ? 'edge-' : opts.isDev ? '' : '../'\n  }${INSTRUMENTATION_HOOK_FILENAME}.js`\n\n  return {\n    import: opts.absolutePagePath,\n    filename,\n    layer: WEBPACK_LAYERS.instrument,\n  }\n}\n\nexport function getAppLoader() {\n  return process.env.BUILTIN_APP_LOADER\n    ? `builtin:next-app-loader`\n    : 'next-app-loader'\n}\n\nexport function getAppEntry(opts: Readonly<AppLoaderOptions>) {\n  if (process.env.NEXT_RSPACK && process.env.BUILTIN_APP_LOADER) {\n    ;(opts as any).projectRoot = normalize(join(__dirname, '../../..'))\n  }\n  return {\n    import: `${getAppLoader()}?${stringify(opts)}!`,\n    layer: WEBPACK_LAYERS.reactServerComponents,\n  }\n}\n\nexport function getClientEntry(opts: {\n  absolutePagePath: string\n  page: string\n}) {\n  const loaderOptions: ClientPagesLoaderOptions = {\n    absolutePagePath: opts.absolutePagePath,\n    page: opts.page,\n  }\n\n  const pageLoader = `next-client-pages-loader?${stringify(loaderOptions)}!`\n\n  // Make sure next/router is a dependency of _app or else chunk splitting\n  // might cause the router to not be able to load causing hydration\n  // to fail\n  return opts.page === '/_app'\n    ? [pageLoader, require.resolve('../client/router')]\n    : pageLoader\n}\n\nexport function runDependingOnPageType<T>(params: {\n  onClient: () => T\n  onEdgeServer: () => T\n  onServer: () => T\n  page: string\n  pageRuntime: ServerRuntime\n  pageType?: PAGE_TYPES\n}): void {\n  if (\n    params.pageType === PAGE_TYPES.ROOT &&\n    isInstrumentationHookFile(params.page)\n  ) {\n    params.onServer()\n    params.onEdgeServer()\n    return\n  }\n\n  if (isProxyFile(params.page)) {\n    params.onServer()\n    return\n  }\n\n  if (isMiddlewareFile(params.page)) {\n    if (params.pageRuntime === 'nodejs') {\n      params.onServer()\n      return\n    } else {\n      params.onEdgeServer()\n      return\n    }\n  }\n\n  if (isAPIRoute(params.page)) {\n    if (isEdgeRuntime(params.pageRuntime)) {\n      params.onEdgeServer()\n      return\n    }\n\n    params.onServer()\n    return\n  }\n  if (params.page === '/_document') {\n    params.onServer()\n    return\n  }\n  if (\n    params.page === '/_app' ||\n    params.page === '/_error' ||\n    params.page === '/404' ||\n    params.page === '/500'\n  ) {\n    params.onClient()\n    params.onServer()\n    return\n  }\n  if (isEdgeRuntime(params.pageRuntime)) {\n    params.onClient()\n    params.onEdgeServer()\n    return\n  }\n\n  params.onClient()\n  params.onServer()\n  return\n}\n\nexport async function createEntrypoints(\n  params: CreateEntrypointsParams\n): Promise<{\n  client: webpack.EntryObject\n  server: webpack.EntryObject\n  edgeServer: webpack.EntryObject\n  middlewareMatchers: undefined\n}> {\n  const {\n    config,\n    pages,\n    pagesDir,\n    isDev,\n    rootDir,\n    rootPaths,\n    appDir,\n    appPaths,\n    pageExtensions,\n  } = params\n  const edgeServer: webpack.EntryObject = {}\n  const server: webpack.EntryObject = {}\n  const client: webpack.EntryObject = {}\n  let middlewareMatchers: ProxyMatcher[] | undefined = undefined\n\n  let appPathsPerRoute: Record<string, string[]> = {}\n  if (appDir && appPaths) {\n    for (const pathname in appPaths) {\n      const normalizedPath = normalizeAppPath(pathname)\n      const actualPath = appPaths[pathname]\n      if (!appPathsPerRoute[normalizedPath]) {\n        appPathsPerRoute[normalizedPath] = []\n      }\n      appPathsPerRoute[normalizedPath].push(\n        // TODO-APP: refactor to pass the page path from createPagesMapping instead.\n        getPageFromPath(actualPath, pageExtensions).replace(APP_DIR_ALIAS, '')\n      )\n    }\n\n    // TODO: find a better place to do this\n    normalizeCatchAllRoutes(appPathsPerRoute)\n\n    // Make sure to sort parallel routes to make the result deterministic.\n    appPathsPerRoute = Object.fromEntries(\n      Object.entries(appPathsPerRoute).map(([k, v]) => [k, v.sort()])\n    )\n  }\n\n  const getEntryHandler =\n    (mappings: MappedPages, pagesType: PAGE_TYPES): ((page: string) => void) =>\n    async (page) => {\n      const bundleFile = normalizePagePath(page)\n      const clientBundlePath = posix.join(pagesType, bundleFile)\n      const serverBundlePath =\n        pagesType === PAGE_TYPES.PAGES\n          ? posix.join('pages', bundleFile)\n          : pagesType === PAGE_TYPES.APP\n            ? posix.join('app', bundleFile)\n            : bundleFile.slice(1)\n\n      const absolutePagePath = mappings[page]\n\n      // Handle paths that have aliases\n      const pageFilePath = getPageFilePath({\n        absolutePagePath,\n        pagesDir,\n        appDir,\n        rootDir,\n      })\n\n      const isInsideAppDir =\n        !!appDir &&\n        (absolutePagePath.startsWith(APP_DIR_ALIAS) ||\n          absolutePagePath.startsWith(appDir))\n\n      const staticInfo: PageStaticInfo = await getStaticInfoIncludingLayouts({\n        isInsideAppDir,\n        pageExtensions,\n        pageFilePath,\n        appDir,\n        config,\n        isDev,\n        page,\n      })\n\n      // TODO(timneutkens): remove this\n      const isServerComponent =\n        isInsideAppDir && staticInfo.rsc !== RSC_MODULE_TYPES.client\n\n      if (isMiddlewareFile(page)) {\n        middlewareMatchers = staticInfo.middleware?.matchers ?? [\n          { regexp: '.*', originalSource: '/:path*' },\n        ]\n      }\n\n      const isInstrumentation =\n        isInstrumentationHookFile(page) && pagesType === PAGE_TYPES.ROOT\n\n      runDependingOnPageType({\n        page,\n        pageRuntime: staticInfo.runtime,\n        pageType: pagesType,\n        onClient: () => {\n          if (isServerComponent || isInsideAppDir) {\n            // We skip the initial entries for server component pages and let the\n            // server compiler inject them instead.\n          } else {\n            client[clientBundlePath] = getClientEntry({\n              absolutePagePath,\n              page,\n            })\n          }\n        },\n        onServer: () => {\n          if (pagesType === 'app' && appDir) {\n            const matchedAppPaths = appPathsPerRoute[normalizeAppPath(page)]\n            server[serverBundlePath] = getAppEntry({\n              page,\n              name: serverBundlePath,\n              pagePath: absolutePagePath,\n              appDir,\n              appPaths: matchedAppPaths,\n              pageExtensions,\n              basePath: config.basePath,\n              assetPrefix: config.assetPrefix,\n              nextConfigOutput: config.output,\n              preferredRegion: staticInfo.preferredRegion,\n              middlewareConfig: encodeToBase64(staticInfo.middleware || {}),\n              isGlobalNotFoundEnabled: config.experimental.globalNotFound\n                ? true\n                : undefined,\n            })\n          } else if (isInstrumentation) {\n            server[serverBundlePath.replace('src/', '')] =\n              getInstrumentationEntry({\n                absolutePagePath,\n                isEdgeServer: false,\n                isDev: false,\n              })\n          } else if (isMiddlewareFile(page)) {\n            server[serverBundlePath.replace('src/', '')] = getEdgeServerEntry({\n              ...params,\n              rootDir,\n              absolutePagePath: absolutePagePath,\n              bundlePath: clientBundlePath,\n              isDev: false,\n              isServerComponent,\n              page,\n              middleware: staticInfo?.middleware,\n              pagesType,\n              preferredRegion: staticInfo.preferredRegion,\n              middlewareConfig: staticInfo.middleware,\n            })\n          } else if (isAPIRoute(page)) {\n            server[serverBundlePath] = [\n              getRouteLoaderEntry({\n                kind: RouteKind.PAGES_API,\n                page,\n                absolutePagePath,\n                preferredRegion: staticInfo.preferredRegion,\n                middlewareConfig: staticInfo.middleware || {},\n              }),\n            ]\n          } else if (\n            !isMiddlewareFile(page) &&\n            !isInternalComponent(absolutePagePath) &&\n            !isNonRoutePagesPage(page)\n          ) {\n            server[serverBundlePath] = [\n              getRouteLoaderEntry({\n                kind: RouteKind.PAGES,\n                page,\n                pages,\n                absolutePagePath,\n                preferredRegion: staticInfo.preferredRegion,\n                middlewareConfig: staticInfo.middleware ?? {},\n              }),\n            ]\n          } else {\n            server[serverBundlePath] = [absolutePagePath]\n          }\n        },\n        onEdgeServer: () => {\n          let appDirLoader: string = ''\n          if (isInstrumentation) {\n            edgeServer[serverBundlePath.replace('src/', '')] =\n              getInstrumentationEntry({\n                absolutePagePath,\n                isEdgeServer: true,\n                isDev: false,\n              })\n          } else {\n            if (pagesType === 'app') {\n              const matchedAppPaths = appPathsPerRoute[normalizeAppPath(page)]\n              appDirLoader = getAppEntry({\n                name: serverBundlePath,\n                page,\n                pagePath: absolutePagePath,\n                appDir: appDir!,\n                appPaths: matchedAppPaths,\n                pageExtensions,\n                basePath: config.basePath,\n                assetPrefix: config.assetPrefix,\n                nextConfigOutput: config.output,\n                // This isn't used with edge as it needs to be set on the entry module, which will be the `edgeServerEntry` instead.\n                // Still passing it here for consistency.\n                preferredRegion: staticInfo.preferredRegion,\n                middlewareConfig: Buffer.from(\n                  JSON.stringify(staticInfo.middleware || {})\n                ).toString('base64'),\n                isGlobalNotFoundEnabled: config.experimental.globalNotFound\n                  ? true\n                  : undefined,\n              }).import\n            }\n            edgeServer[serverBundlePath] = getEdgeServerEntry({\n              ...params,\n              rootDir,\n              absolutePagePath: absolutePagePath,\n              bundlePath: clientBundlePath,\n              isDev: false,\n              isServerComponent,\n              page,\n              middleware: staticInfo?.middleware,\n              pagesType,\n              appDirLoader,\n              preferredRegion: staticInfo.preferredRegion,\n              middlewareConfig: staticInfo.middleware,\n            })\n          }\n        },\n      })\n    }\n\n  const promises: Promise<void[]>[] = []\n\n  if (appPaths) {\n    const entryHandler = getEntryHandler(appPaths, PAGE_TYPES.APP)\n    promises.push(Promise.all(Object.keys(appPaths).map(entryHandler)))\n  }\n  if (rootPaths) {\n    promises.push(\n      Promise.all(\n        Object.keys(rootPaths).map(getEntryHandler(rootPaths, PAGE_TYPES.ROOT))\n      )\n    )\n  }\n  promises.push(\n    Promise.all(\n      Object.keys(pages).map(getEntryHandler(pages, PAGE_TYPES.PAGES))\n    )\n  )\n\n  await Promise.all(promises)\n\n  // Optimization: If there's only one instrumentation hook in edge compiler, which means there's no edge server entry.\n  // We remove the edge instrumentation entry from edge compiler as it can be pure server side.\n  if (edgeServer.instrumentation && Object.keys(edgeServer).length === 1) {\n    delete edgeServer.instrumentation\n  }\n\n  return {\n    client,\n    server,\n    edgeServer,\n    middlewareMatchers,\n  }\n}\n\nexport function finalizeEntrypoint({\n  name,\n  compilerType,\n  value,\n  isServerComponent,\n  hasAppDir,\n}: {\n  compilerType: CompilerNameValues\n  name: string\n  value: ObjectValue<webpack.EntryObject>\n  isServerComponent?: boolean\n  hasAppDir?: boolean\n}): ObjectValue<webpack.EntryObject> {\n  const entry =\n    typeof value !== 'object' || Array.isArray(value)\n      ? { import: value }\n      : value\n\n  const isApi = name.startsWith('pages/api/')\n  const isInstrumentation = isInstrumentationHookFilename(name)\n\n  switch (compilerType) {\n    case COMPILER_NAMES.server: {\n      const layer = isApi\n        ? WEBPACK_LAYERS.apiNode\n        : isInstrumentation\n          ? WEBPACK_LAYERS.instrument\n          : isServerComponent\n            ? WEBPACK_LAYERS.reactServerComponents\n            : name.startsWith('pages/')\n              ? WEBPACK_LAYERS.pagesDirNode\n              : undefined\n\n      return {\n        publicPath: isApi ? '' : undefined,\n        runtime: isApi ? 'webpack-api-runtime' : 'webpack-runtime',\n        layer,\n        ...entry,\n      }\n    }\n    case COMPILER_NAMES.edgeServer: {\n      return {\n        layer: isApi\n          ? WEBPACK_LAYERS.apiEdge\n          : isMiddlewareFilename(name) || isInstrumentation\n            ? WEBPACK_LAYERS.middleware\n            : name.startsWith('pages/')\n              ? WEBPACK_LAYERS.pagesDirEdge\n              : undefined,\n        library: { name: ['_ENTRIES', `middleware_[name]`], type: 'assign' },\n        runtime: EDGE_RUNTIME_WEBPACK,\n        asyncChunks: false,\n        ...entry,\n      }\n    }\n    case COMPILER_NAMES.client: {\n      const isAppLayer =\n        hasAppDir &&\n        (name === CLIENT_STATIC_FILES_RUNTIME_MAIN_APP ||\n          name === APP_CLIENT_INTERNALS ||\n          name.startsWith('app/'))\n\n      if (\n        // Client special cases\n        name !== CLIENT_STATIC_FILES_RUNTIME_POLYFILLS &&\n        name !== CLIENT_STATIC_FILES_RUNTIME_MAIN &&\n        name !== CLIENT_STATIC_FILES_RUNTIME_MAIN_APP &&\n        name !== CLIENT_STATIC_FILES_RUNTIME_REACT_REFRESH\n      ) {\n        if (isAppLayer) {\n          return {\n            dependOn: CLIENT_STATIC_FILES_RUNTIME_MAIN_APP,\n            layer: WEBPACK_LAYERS.appPagesBrowser,\n            ...entry,\n          }\n        }\n\n        return {\n          dependOn:\n            name.startsWith('pages/') && name !== 'pages/_app'\n              ? 'pages/_app'\n              : CLIENT_STATIC_FILES_RUNTIME_MAIN,\n          layer: WEBPACK_LAYERS.pagesDirBrowser,\n          ...entry,\n        }\n      }\n\n      if (isAppLayer) {\n        return {\n          layer: WEBPACK_LAYERS.appPagesBrowser,\n          ...entry,\n        }\n      }\n\n      return {\n        layer: WEBPACK_LAYERS.pagesDirBrowser,\n        ...entry,\n      }\n    }\n    default:\n      return compilerType satisfies never\n  }\n}\n"],"names":["collectAppFiles","collectPagesFiles","combineSlots","createEntrypoints","createPagesMapping","createRelativeFilePath","extractSlotsFromAppRoutes","extractSlotsFromDefaultFiles","finalizeEntrypoint","getAppEntry","getAppLoader","getClientEntry","getEdgeServerEntry","getInstrumentationEntry","getPageFilePath","getPageFromPath","processAppRoutes","processLayoutRoutes","processPageRoutes","runDependingOnPageType","appDir","validFileMatcher","allAppFiles","recursiveReadDir","pathnameFilter","absolutePath","isAppRouterPage","isRootNotFound","isAppLayoutPage","isAppDefaultPage","ignorePartFilter","part","startsWith","appPaths","filter","layoutPaths","defaultPaths","pagesDir","isPageFile","baseDir","filePath","prefix","isSrcDir","privatePrefix","srcPrefix","join","replace","RegExp","mappedPages","pageRoutes","pageApiRoutes","route","Object","entries","relativeFilePath","push","normalizePathSep","isReservedPage","mappedAppPages","slots","page","UNDERSCORE_NOT_FOUND_ROUTE_ENTRY","UNDERSCORE_GLOBAL_ERROR_ROUTE_ENTRY","segments","split","i","length","segment","isParallelRouteSegment","parentPath","normalizeAppPath","slice","slotName","some","s","name","parent","mappedDefaultFiles","slotArrays","slotSet","Set","result","slot","key","has","add","appRoutes","appRouteHandlers","isAppRouterRoute","mappedAppLayouts","layoutRoutes","ensureLeadingSlash","pagePath","pageExtensions","absolutePagePath","rootDir","PAGES_DIR_ALIAS","APP_DIR_ALIAS","ROOT_DIR_ALIAS","require","resolve","isDev","pagePaths","pagesType","appDirOnly","isAppRoute","promises","map","endsWith","includes","pageKey","UNDERSCORE_NOT_FOUND_ROUTE","UNDERSCORE_GLOBAL_ERROR_ROUTE","normalizedPath","normalizeMetadataRoute","isMetadataRouteFile","staticInfo","getPageStaticInfo","nextConfig","pageFilePath","pageType","normalizeMetadataPageToRoute","generateImageMetadata","generateSitemaps","pages","fromEntries","Promise","all","entry","PAGE_TYPES","ROOT","APP","hasAppPages","keys","hasAppGlobalError","PAGES","root","opts","isAppRouteRoute","appDirLoader","loaderParams","Buffer","from","toString","preferredRegion","middlewareConfig","JSON","stringify","cacheHandlers","config","import","layer","WEBPACK_LAYERS","reactServerComponents","isMiddlewareFile","matchers","middleware","encodeMatchers","filename","undefined","isAPIRoute","apiEdge","absolute500Path","absoluteAppPath","absoluteDocumentPath","absoluteErrorPath","dev","isServerComponent","sriEnabled","experimental","sri","algorithm","cacheHandler","serverActions","serverSideRendering","isEdgeServer","INSTRUMENTATION_HOOK_FILENAME","instrument","process","env","BUILTIN_APP_LOADER","NEXT_RSPACK","projectRoot","normalize","__dirname","loaderOptions","pageLoader","params","isInstrumentationHookFile","onServer","onEdgeServer","isProxyFile","pageRuntime","isEdgeRuntime","onClient","rootPaths","edgeServer","server","client","middlewareMatchers","appPathsPerRoute","pathname","actualPath","normalizeCatchAllRoutes","k","v","sort","getEntryHandler","mappings","bundleFile","normalizePagePath","clientBundlePath","posix","serverBundlePath","isInsideAppDir","getStaticInfoIncludingLayouts","rsc","RSC_MODULE_TYPES","regexp","originalSource","isInstrumentation","runtime","matchedAppPaths","basePath","assetPrefix","nextConfigOutput","output","encodeToBase64","isGlobalNotFoundEnabled","globalNotFound","bundlePath","getRouteLoaderEntry","kind","RouteKind","PAGES_API","isInternalComponent","isNonRoutePagesPage","entryHandler","instrumentation","compilerType","value","hasAppDir","Array","isArray","isApi","isInstrumentationHookFilename","COMPILER_NAMES","apiNode","pagesDirNode","publicPath","isMiddlewareFilename","pagesDirEdge","library","type","EDGE_RUNTIME_WEBPACK","asyncChunks","isAppLayer","CLIENT_STATIC_FILES_RUNTIME_MAIN_APP","APP_CLIENT_INTERNALS","CLIENT_STATIC_FILES_RUNTIME_POLYFILLS","CLIENT_STATIC_FILES_RUNTIME_MAIN","CLIENT_STATIC_FILES_RUNTIME_REACT_REFRESH","dependOn","appPagesBrowser","pagesDirBrowser"],"mappings":"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","ignoreList":[0]}