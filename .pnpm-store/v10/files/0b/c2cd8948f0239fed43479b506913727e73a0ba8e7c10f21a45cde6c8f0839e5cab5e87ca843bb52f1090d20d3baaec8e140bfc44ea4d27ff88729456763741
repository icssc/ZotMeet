{"version":3,"file":"varbinary.js","names":["str: string[]"],"sources":["../../../src/mysql-core/columns/varbinary.ts"],"sourcesContent":["import type { ColumnBaseConfig } from '~/column.ts';\nimport { entityKind } from '~/entity.ts';\nimport type { MySqlTable } from '~/mysql-core/table.ts';\nimport { getColumnNameAndConfig } from '~/utils.ts';\nimport { MySqlColumn, MySqlColumnBuilder } from './common.ts';\n\nexport class MySqlVarBinaryBuilder extends MySqlColumnBuilder<{\n\tdataType: 'string binary';\n\tdata: string;\n\tdriverParam: string;\n}, MySqlVarbinaryOptions> {\n\tstatic override readonly [entityKind]: string = 'MySqlVarBinaryBuilder';\n\n\t/** @internal */\n\tconstructor(name: string, config: MySqlVarbinaryOptions) {\n\t\tsuper(name, 'string binary', 'MySqlVarBinary');\n\t\tthis.config.length = config.length;\n\t}\n\n\t/** @internal */\n\toverride build(table: MySqlTable) {\n\t\treturn new MySqlVarBinary(\n\t\t\ttable,\n\t\t\tthis.config as any,\n\t\t);\n\t}\n}\n\nexport class MySqlVarBinary<\n\tT extends ColumnBaseConfig<'string binary'>,\n> extends MySqlColumn<T, MySqlVarbinaryOptions> {\n\tstatic override readonly [entityKind]: string = 'MySqlVarBinary';\n\n\toverride mapFromDriverValue(value: string | Buffer | Uint8Array): string {\n\t\tif (typeof value === 'string') return value;\n\t\tif (Buffer.isBuffer(value)) return value.toString();\n\n\t\tconst str: string[] = [];\n\t\tfor (const v of value) {\n\t\t\tstr.push(v === 49 ? '1' : '0');\n\t\t}\n\n\t\treturn str.join('');\n\t}\n\n\tgetSQLType(): string {\n\t\treturn this.length === undefined ? `varbinary` : `varbinary(${this.length})`;\n\t}\n}\n\nexport interface MySqlVarbinaryOptions {\n\tlength: number;\n}\n\nexport function varbinary(\n\tconfig: MySqlVarbinaryOptions,\n): MySqlVarBinaryBuilder;\nexport function varbinary(\n\tname: string,\n\tconfig: MySqlVarbinaryOptions,\n): MySqlVarBinaryBuilder;\nexport function varbinary(a?: string | MySqlVarbinaryOptions, b?: MySqlVarbinaryOptions) {\n\tconst { name, config } = getColumnNameAndConfig<MySqlVarbinaryOptions>(a, b);\n\treturn new MySqlVarBinaryBuilder(name, config);\n}\n"],"mappings":";;;;;AAMA,IAAa,wBAAb,cAA2C,mBAIjB;CACzB,QAA0B,cAAsB;;CAGhD,YAAY,MAAc,QAA+B;AACxD,QAAM,MAAM,iBAAiB,iBAAiB;AAC9C,OAAK,OAAO,SAAS,OAAO;;;CAI7B,AAAS,MAAM,OAAmB;AACjC,SAAO,IAAI,eACV,OACA,KAAK,OACL;;;AAIH,IAAa,iBAAb,cAEU,YAAsC;CAC/C,QAA0B,cAAsB;CAEhD,AAAS,mBAAmB,OAA6C;AACxE,MAAI,OAAO,UAAU,SAAU,QAAO;AACtC,MAAI,OAAO,SAAS,MAAM,CAAE,QAAO,MAAM,UAAU;EAEnD,MAAMA,MAAgB,EAAE;AACxB,OAAK,MAAM,KAAK,MACf,KAAI,KAAK,MAAM,KAAK,MAAM,IAAI;AAG/B,SAAO,IAAI,KAAK,GAAG;;CAGpB,aAAqB;AACpB,SAAO,KAAK,WAAW,SAAY,cAAc,aAAa,KAAK,OAAO;;;AAe5E,SAAgB,UAAU,GAAoC,GAA2B;CACxF,MAAM,EAAE,MAAM,WAAW,uBAA8C,GAAG,EAAE;AAC5E,QAAO,IAAI,sBAAsB,MAAM,OAAO"}