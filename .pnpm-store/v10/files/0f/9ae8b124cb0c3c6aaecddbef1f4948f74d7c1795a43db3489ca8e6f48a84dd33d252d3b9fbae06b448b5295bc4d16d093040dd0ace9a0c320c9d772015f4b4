{"version":3,"file":"query-effect.cjs","names":["entityKind","Effect"],"sources":["../../src/effect-core/query-effect.ts"],"sourcesContent":["import { Effect } from 'effect';\nimport type { Pipeable } from 'effect/Pipeable';\nimport { entityKind } from '~/entity.ts';\nimport { applyMixins } from '~/utils.ts';\nimport type { TaggedDrizzleQueryError } from './errors.ts';\n\nexport interface QueryEffect<Success = never, Failure = TaggedDrizzleQueryError, Context = never>\n\textends Effect.Effect<Success, Failure, Context>\n{\n}\n\nexport abstract class QueryEffect<Success = never, Failure = TaggedDrizzleQueryError, Context = never> {\n\tstatic readonly [entityKind]: string = 'EffectWrapper';\n\n\tprotected _effect!: Effect.Effect<Success, Failure, Context>;\n\tprotected get effect() {\n\t\tthis._effect = Effect.suspend(() => this.execute());\n\n\t\tObject.defineProperty(this, 'effect', {\n\t\t\tvalue: this._effect,\n\t\t\twritable: false,\n\t\t\tconfigurable: false,\n\t\t});\n\n\t\treturn this._effect;\n\t}\n\n\tprivate _pipe!: Pipeable['pipe'];\n\tget pipe() {\n\t\tthis._pipe = (...args: any[]) => {\n\t\t\treturn (this.effect.pipe as (...args: any[]) => any)(...args);\n\t\t};\n\n\t\tObject.defineProperty(this, 'pipe', {\n\t\t\tvalue: this._pipe,\n\t\t\twritable: false,\n\t\t\tconfigurable: false,\n\t\t});\n\n\t\treturn this._pipe;\n\t}\n\n\tabstract execute(...args: any[]): Effect.Effect<Success, Failure, Context>;\n\n\tget [Effect.EffectTypeId]() {\n\t\treturn this.effect[Effect.EffectTypeId];\n\t}\n\n\t[Symbol.iterator]() {\n\t\treturn this.effect[Symbol.iterator]();\n\t}\n}\n\nexport function applyEffectWrapper(baseClass: any) {\n\tapplyMixins(baseClass, [QueryEffect]);\n\n\tObject.defineProperty(\n\t\tbaseClass.prototype,\n\t\tSymbol.iterator,\n\t\tObject.getOwnPropertyDescriptor(QueryEffect.prototype, Symbol.iterator)!,\n\t);\n\n\tObject.defineProperty(\n\t\tbaseClass.prototype,\n\t\tEffect.EffectTypeId,\n\t\tObject.getOwnPropertyDescriptor(QueryEffect.prototype, Effect.EffectTypeId)!,\n\t);\n}\n"],"mappings":";;;;;;AAWA,IAAsB,cAAtB,MAAuG;CACtG,QAAiBA,0BAAsB;CAEvC,AAAU;CACV,IAAc,SAAS;AACtB,OAAK,UAAUC,cAAO,cAAc,KAAK,SAAS,CAAC;AAEnD,SAAO,eAAe,MAAM,UAAU;GACrC,OAAO,KAAK;GACZ,UAAU;GACV,cAAc;GACd,CAAC;AAEF,SAAO,KAAK;;CAGb,AAAQ;CACR,IAAI,OAAO;AACV,OAAK,SAAS,GAAG,SAAgB;AAChC,UAAQ,KAAK,OAAO,KAAiC,GAAG,KAAK;;AAG9D,SAAO,eAAe,MAAM,QAAQ;GACnC,OAAO,KAAK;GACZ,UAAU;GACV,cAAc;GACd,CAAC;AAEF,SAAO,KAAK;;CAKb,KAAKA,cAAO,gBAAgB;AAC3B,SAAO,KAAK,OAAOA,cAAO;;CAG3B,CAAC,OAAO,YAAY;AACnB,SAAO,KAAK,OAAO,OAAO,WAAW;;;AAIvC,SAAgB,mBAAmB,WAAgB;AAClD,6BAAY,WAAW,CAAC,YAAY,CAAC;AAErC,QAAO,eACN,UAAU,WACV,OAAO,UACP,OAAO,yBAAyB,YAAY,WAAW,OAAO,SAAS,CACvE;AAED,QAAO,eACN,UAAU,WACVA,cAAO,cACP,OAAO,yBAAyB,YAAY,WAAWA,cAAO,aAAa,CAC3E"}