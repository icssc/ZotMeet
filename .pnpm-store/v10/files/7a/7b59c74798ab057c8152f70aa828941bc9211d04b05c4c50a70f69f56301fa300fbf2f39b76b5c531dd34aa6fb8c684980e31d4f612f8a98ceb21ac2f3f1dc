{"version":3,"file":"varchar.js","names":[],"sources":["../../../src/cockroach-core/columns/varchar.ts"],"sourcesContent":["import type { AnyCockroachTable } from '~/cockroach-core/table.ts';\nimport type { ColumnBaseConfig } from '~/column.ts';\nimport { entityKind } from '~/entity.ts';\nimport { type Equal, getColumnNameAndConfig, type Writable } from '~/utils.ts';\nimport { CockroachColumn, CockroachColumnWithArrayBuilder } from './common.ts';\n\nexport class CockroachVarcharBuilder<\n\tTEnum extends [string, ...string[]],\n> extends CockroachColumnWithArrayBuilder<\n\t{\n\t\tdataType: Equal<TEnum, [string, ...string[]]> extends true ? 'string' : 'string enum';\n\t\tdata: TEnum[number];\n\t\tdriverParam: string;\n\t\tenumValues: TEnum;\n\t},\n\t{ length: number | undefined; enumValues: TEnum | undefined }\n> {\n\tstatic override readonly [entityKind]: string = 'CockroachVarcharBuilder';\n\n\tconstructor(name: string, config: CockroachVarcharConfig<TEnum>) {\n\t\tsuper(name, config.enum?.length ? 'string enum' : 'string', 'CockroachVarchar');\n\t\tthis.config.length = config.length;\n\t\tthis.config.enumValues = config.enum;\n\t}\n\n\t/** @internal */\n\toverride build<TTableName extends string>(\n\t\ttable: AnyCockroachTable<{ name: TTableName }>,\n\t) {\n\t\treturn new CockroachVarchar(\n\t\t\ttable,\n\t\t\tthis.config,\n\t\t);\n\t}\n}\n\nexport class CockroachVarchar<\n\tT extends ColumnBaseConfig<'string' | 'string enum'>,\n> extends CockroachColumn<T, { length: number | undefined; enumValues: T['enumValues'] }> {\n\tstatic override readonly [entityKind]: string = 'CockroachVarchar';\n\n\toverride readonly enumValues = this.config.enumValues;\n\n\tgetSQLType(): string {\n\t\treturn this.length === undefined ? `varchar` : `varchar(${this.length})`;\n\t}\n}\n\nexport interface CockroachVarcharConfig<\n\tTEnum extends readonly string[] | string[] | undefined = readonly string[] | string[] | undefined,\n> {\n\tenum?: TEnum;\n\tlength?: number | undefined;\n}\n\nexport function varchar<\n\tU extends string,\n\tT extends Readonly<[U, ...U[]]>,\n>(\n\tconfig?: CockroachVarcharConfig<T | Writable<T>>,\n): CockroachVarcharBuilder<Writable<T>>;\nexport function varchar<\n\tU extends string,\n\tT extends Readonly<[U, ...U[]]>,\n>(\n\tname: string,\n\tconfig?: CockroachVarcharConfig<T | Writable<T>>,\n): CockroachVarcharBuilder<Writable<T>>;\nexport function varchar(a?: string | CockroachVarcharConfig, b: CockroachVarcharConfig = {}): any {\n\tconst { name, config } = getColumnNameAndConfig<CockroachVarcharConfig>(a, b);\n\treturn new CockroachVarcharBuilder(name, config as any);\n}\n"],"mappings":";;;;;AAMA,IAAa,0BAAb,cAEU,gCAQR;CACD,QAA0B,cAAsB;CAEhD,YAAY,MAAc,QAAuC;AAChE,QAAM,MAAM,OAAO,MAAM,SAAS,gBAAgB,UAAU,mBAAmB;AAC/E,OAAK,OAAO,SAAS,OAAO;AAC5B,OAAK,OAAO,aAAa,OAAO;;;CAIjC,AAAS,MACR,OACC;AACD,SAAO,IAAI,iBACV,OACA,KAAK,OACL;;;AAIH,IAAa,mBAAb,cAEU,gBAAgF;CACzF,QAA0B,cAAsB;CAEhD,AAAkB,aAAa,KAAK,OAAO;CAE3C,aAAqB;AACpB,SAAO,KAAK,WAAW,SAAY,YAAY,WAAW,KAAK,OAAO;;;AAwBxE,SAAgB,QAAQ,GAAqC,IAA4B,EAAE,EAAO;CACjG,MAAM,EAAE,MAAM,WAAW,uBAA+C,GAAG,EAAE;AAC7E,QAAO,IAAI,wBAAwB,MAAM,OAAc"}