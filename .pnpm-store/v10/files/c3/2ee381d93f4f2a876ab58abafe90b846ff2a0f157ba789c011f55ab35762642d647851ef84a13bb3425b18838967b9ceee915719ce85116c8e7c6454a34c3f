{"version":3,"file":"logger.js","names":[],"sources":["../src/logger.ts"],"sourcesContent":["import { entityKind } from '~/entity.ts';\n\nexport interface Logger {\n\tlogQuery(query: string, params: unknown[]): void;\n}\n\nexport interface LogWriter {\n\twrite(message: string): void;\n}\n\nexport class ConsoleLogWriter implements LogWriter {\n\tstatic readonly [entityKind]: string = 'ConsoleLogWriter';\n\n\twrite(message: string) {\n\t\tconsole.log(message);\n\t}\n}\n\nexport class DefaultLogger implements Logger {\n\tstatic readonly [entityKind]: string = 'DefaultLogger';\n\n\treadonly writer: LogWriter;\n\n\tconstructor(config?: { writer: LogWriter }) {\n\t\tthis.writer = config?.writer ?? new ConsoleLogWriter();\n\t}\n\n\tlogQuery(query: string, params: unknown[]): void {\n\t\tconst stringifiedParams = params.map((p) => {\n\t\t\ttry {\n\t\t\t\treturn JSON.stringify(p);\n\t\t\t} catch {\n\t\t\t\treturn String(p);\n\t\t\t}\n\t\t});\n\t\tconst paramsStr = stringifiedParams.length ? ` -- params: [${stringifiedParams.join(', ')}]` : '';\n\t\tthis.writer.write(`Query: ${query}${paramsStr}`);\n\t}\n}\n\nexport class NoopLogger implements Logger {\n\tstatic readonly [entityKind]: string = 'NoopLogger';\n\n\tlogQuery(): void {\n\t\t// noop\n\t}\n}\n"],"mappings":";;;AAUA,IAAa,mBAAb,MAAmD;CAClD,QAAiB,cAAsB;CAEvC,MAAM,SAAiB;AACtB,UAAQ,IAAI,QAAQ;;;AAItB,IAAa,gBAAb,MAA6C;CAC5C,QAAiB,cAAsB;CAEvC,AAAS;CAET,YAAY,QAAgC;AAC3C,OAAK,SAAS,QAAQ,UAAU,IAAI,kBAAkB;;CAGvD,SAAS,OAAe,QAAyB;EAChD,MAAM,oBAAoB,OAAO,KAAK,MAAM;AAC3C,OAAI;AACH,WAAO,KAAK,UAAU,EAAE;WACjB;AACP,WAAO,OAAO,EAAE;;IAEhB;EACF,MAAM,YAAY,kBAAkB,SAAS,gBAAgB,kBAAkB,KAAK,KAAK,CAAC,KAAK;AAC/F,OAAK,OAAO,MAAM,UAAU,QAAQ,YAAY;;;AAIlD,IAAa,aAAb,MAA0C;CACzC,QAAiB,cAAsB;CAEvC,WAAiB"}