{"version":3,"file":"binary.js","names":["str: string[]"],"sources":["../../../src/singlestore-core/columns/binary.ts"],"sourcesContent":["import type { ColumnBaseConfig } from '~/column.ts';\nimport { entityKind } from '~/entity.ts';\nimport type { SingleStoreTable } from '~/singlestore-core/table.ts';\nimport { getColumnNameAndConfig } from '~/utils.ts';\nimport { SingleStoreColumn, SingleStoreColumnBuilder } from './common.ts';\n\nexport class SingleStoreBinaryBuilder extends SingleStoreColumnBuilder<\n\t{\n\t\tdataType: 'string binary';\n\t\tdata: string;\n\t\tdriverParam: string;\n\t},\n\tSingleStoreBinaryConfig & { setLength: boolean }\n> {\n\tstatic override readonly [entityKind]: string = 'SingleStoreBinaryBuilder';\n\n\tconstructor(name: string, length: number | undefined) {\n\t\tsuper(name, 'string binary', 'SingleStoreBinary');\n\t\tthis.config.length = length ?? 1;\n\t\tthis.config.setLength = length !== undefined;\n\t}\n\n\t/** @internal */\n\toverride build(table: SingleStoreTable) {\n\t\treturn new SingleStoreBinary(\n\t\t\ttable,\n\t\t\tthis.config as any,\n\t\t);\n\t}\n}\n\nexport class SingleStoreBinary<T extends ColumnBaseConfig<'string binary'>> extends SingleStoreColumn<\n\tT,\n\tSingleStoreBinaryConfig & { setLength: boolean }\n> {\n\tstatic override readonly [entityKind]: string = 'SingleStoreBinary';\n\n\toverride mapFromDriverValue(value: string | Buffer | Uint8Array): string {\n\t\tif (typeof value === 'string') return value;\n\t\tif (Buffer.isBuffer(value)) return value.toString();\n\n\t\tconst str: string[] = [];\n\t\tfor (const v of value) {\n\t\t\tstr.push(v === 49 ? '1' : '0');\n\t\t}\n\n\t\treturn str.join('');\n\t}\n\n\tgetSQLType(): string {\n\t\treturn this.config.setLength ? `binary(${this.length})` : `binary`;\n\t}\n}\n\nexport interface SingleStoreBinaryConfig {\n\tlength?: number;\n}\n\nexport function binary(\n\tconfig?: SingleStoreBinaryConfig,\n): SingleStoreBinaryBuilder;\nexport function binary(\n\tname: string,\n\tconfig?: SingleStoreBinaryConfig,\n): SingleStoreBinaryBuilder;\nexport function binary(a?: string | SingleStoreBinaryConfig, b: SingleStoreBinaryConfig = {}) {\n\tconst { name, config } = getColumnNameAndConfig<SingleStoreBinaryConfig>(a, b);\n\treturn new SingleStoreBinaryBuilder(name, config.length);\n}\n"],"mappings":";;;;;AAMA,IAAa,2BAAb,cAA8C,yBAO5C;CACD,QAA0B,cAAsB;CAEhD,YAAY,MAAc,QAA4B;AACrD,QAAM,MAAM,iBAAiB,oBAAoB;AACjD,OAAK,OAAO,SAAS,UAAU;AAC/B,OAAK,OAAO,YAAY,WAAW;;;CAIpC,AAAS,MAAM,OAAyB;AACvC,SAAO,IAAI,kBACV,OACA,KAAK,OACL;;;AAIH,IAAa,oBAAb,cAAoF,kBAGlF;CACD,QAA0B,cAAsB;CAEhD,AAAS,mBAAmB,OAA6C;AACxE,MAAI,OAAO,UAAU,SAAU,QAAO;AACtC,MAAI,OAAO,SAAS,MAAM,CAAE,QAAO,MAAM,UAAU;EAEnD,MAAMA,MAAgB,EAAE;AACxB,OAAK,MAAM,KAAK,MACf,KAAI,KAAK,MAAM,KAAK,MAAM,IAAI;AAG/B,SAAO,IAAI,KAAK,GAAG;;CAGpB,aAAqB;AACpB,SAAO,KAAK,OAAO,YAAY,UAAU,KAAK,OAAO,KAAK;;;AAe5D,SAAgB,OAAO,GAAsC,IAA6B,EAAE,EAAE;CAC7F,MAAM,EAAE,MAAM,WAAW,uBAAgD,GAAG,EAAE;AAC9E,QAAO,IAAI,yBAAyB,MAAM,OAAO,OAAO"}