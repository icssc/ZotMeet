{"version":3,"file":"schema.js","names":["schemaName: TName"],"sources":["../../src/gel-core/schema.ts"],"sourcesContent":["import { entityKind, is } from '~/entity.ts';\nimport { SQL, sql, type SQLWrapper } from '~/sql/sql.ts';\nimport type { gelSequence } from './sequence.ts';\nimport { gelSequenceWithSchema } from './sequence.ts';\nimport { type GelTableFn, gelTableWithSchema } from './table.ts';\n// import type { gelMaterializedView, gelView } from './view.ts';\n// import { gelMaterializedViewWithSchema, gelViewWithSchema } from './view.ts';\n\nexport class GelSchema<TName extends string = string> implements SQLWrapper {\n\tstatic readonly [entityKind]: string = 'GelSchema';\n\tconstructor(\n\t\tpublic readonly schemaName: TName,\n\t) {}\n\n\ttable: GelTableFn<TName> = ((name, columns, extraConfig) => {\n\t\treturn gelTableWithSchema(name, columns, extraConfig, this.schemaName);\n\t});\n\n\t// view = ((name, columns) => {\n\t// \treturn gelViewWithSchema(name, columns, this.schemaName);\n\t// }) as typeof gelView;\n\n\t// materializedView = ((name, columns) => {\n\t// \treturn gelMaterializedViewWithSchema(name, columns, this.schemaName);\n\t// }) as typeof gelMaterializedView;\n\n\t// enum: typeof gelEnum = ((name, values) => {\n\t// \treturn gelEnumWithSchema(name, values, this.schemaName);\n\t// });\n\n\tsequence: typeof gelSequence = ((name, options) => {\n\t\treturn gelSequenceWithSchema(name, options, this.schemaName);\n\t});\n\n\tgetSQL(): SQL {\n\t\treturn new SQL([sql.identifier(this.schemaName)]);\n\t}\n\n\tshouldOmitSQLParens(): boolean {\n\t\treturn true;\n\t}\n}\n\nexport function isGelSchema(obj: unknown): obj is GelSchema {\n\treturn is(obj, GelSchema);\n}\n\nexport function gelSchema<T extends string>(name: T) {\n\tif (name === 'public') {\n\t\tthrow new Error(\n\t\t\t`You can't specify 'public' as schema name. Postgres is using public schema by default. If you want to use 'public' schema, just use GelTable() instead of creating a schema`,\n\t\t);\n\t}\n\n\treturn new GelSchema(name);\n}\n"],"mappings":";;;;;;AAQA,IAAa,YAAb,MAA4E;CAC3E,QAAiB,cAAsB;CACvC,YACC,AAAgBA,YACf;EADe;;CAGjB,UAA6B,MAAM,SAAS,gBAAgB;AAC3D,SAAO,mBAAmB,MAAM,SAAS,aAAa,KAAK,WAAW;;CAevE,aAAiC,MAAM,YAAY;AAClD,SAAO,sBAAsB,MAAM,SAAS,KAAK,WAAW;;CAG7D,SAAc;AACb,SAAO,IAAI,IAAI,CAAC,IAAI,WAAW,KAAK,WAAW,CAAC,CAAC;;CAGlD,sBAA+B;AAC9B,SAAO;;;AAIT,SAAgB,YAAY,KAAgC;AAC3D,QAAO,GAAG,KAAK,UAAU;;AAG1B,SAAgB,UAA4B,MAAS;AACpD,KAAI,SAAS,SACZ,OAAM,IAAI,MACT,8KACA;AAGF,QAAO,IAAI,UAAU,KAAK"}