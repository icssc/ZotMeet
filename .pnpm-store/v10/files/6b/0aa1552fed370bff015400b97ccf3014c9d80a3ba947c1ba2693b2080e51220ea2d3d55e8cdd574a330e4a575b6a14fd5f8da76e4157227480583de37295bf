{"version":3,"file":"numeric.js","names":[],"sources":["../../../src/sqlite-core/columns/numeric.ts"],"sourcesContent":["import type { ColumnBaseConfig } from '~/column.ts';\nimport { entityKind } from '~/entity.ts';\nimport type { SQLiteTable } from '~/sqlite-core/table.ts';\nimport { type Equal, getColumnNameAndConfig } from '~/utils.ts';\nimport { SQLiteColumn, SQLiteColumnBuilder } from './common.ts';\n\nexport class SQLiteNumericBuilder extends SQLiteColumnBuilder<{\n\tdataType: 'string numeric';\n\tdata: string;\n\tdriverParam: string;\n}> {\n\tstatic override readonly [entityKind]: string = 'SQLiteNumericBuilder';\n\n\tconstructor(name: string) {\n\t\tsuper(name, 'string numeric', 'SQLiteNumeric');\n\t}\n\n\t/** @internal */\n\toverride build(table: SQLiteTable) {\n\t\treturn new SQLiteNumeric(\n\t\t\ttable,\n\t\t\tthis.config as any,\n\t\t);\n\t}\n}\n\nexport class SQLiteNumeric<T extends ColumnBaseConfig<'string numeric'>> extends SQLiteColumn<T> {\n\tstatic override readonly [entityKind]: string = 'SQLiteNumeric';\n\n\toverride mapFromDriverValue(value: unknown): string {\n\t\tif (typeof value === 'string') return value;\n\n\t\treturn String(value);\n\t}\n\n\tgetSQLType(): string {\n\t\treturn 'numeric';\n\t}\n}\nexport class SQLiteNumericNumberBuilder extends SQLiteColumnBuilder<{\n\tdataType: 'number';\n\tdata: number;\n\tdriverParam: string;\n}> {\n\tstatic override readonly [entityKind]: string = 'SQLiteNumericNumberBuilder';\n\n\tconstructor(name: string) {\n\t\tsuper(name, 'number', 'SQLiteNumericNumber');\n\t}\n\n\t/** @internal */\n\toverride build(table: SQLiteTable) {\n\t\treturn new SQLiteNumericNumber(\n\t\t\ttable,\n\t\t\tthis.config as any,\n\t\t);\n\t}\n}\n\nexport class SQLiteNumericNumber<T extends ColumnBaseConfig<'number'>> extends SQLiteColumn<T> {\n\tstatic override readonly [entityKind]: string = 'SQLiteNumericNumber';\n\n\toverride mapFromDriverValue(value: unknown): number {\n\t\tif (typeof value === 'number') return value;\n\n\t\treturn Number(value);\n\t}\n\n\toverride mapToDriverValue = String;\n\n\tgetSQLType(): string {\n\t\treturn 'numeric';\n\t}\n}\n\nexport class SQLiteNumericBigIntBuilder extends SQLiteColumnBuilder<{\n\tdataType: 'bigint int64';\n\tdata: bigint;\n\tdriverParam: string;\n}> {\n\tstatic override readonly [entityKind]: string = 'SQLiteNumericBigIntBuilder';\n\n\tconstructor(name: string) {\n\t\tsuper(name, 'bigint int64', 'SQLiteNumericBigInt');\n\t}\n\n\t/** @internal */\n\toverride build(table: SQLiteTable) {\n\t\treturn new SQLiteNumericBigInt(\n\t\t\ttable,\n\t\t\tthis.config as any,\n\t\t);\n\t}\n}\n\nexport class SQLiteNumericBigInt<T extends ColumnBaseConfig<'bigint int64'>> extends SQLiteColumn<T> {\n\tstatic override readonly [entityKind]: string = 'SQLiteNumericBigInt';\n\n\toverride mapFromDriverValue = BigInt;\n\n\toverride mapToDriverValue = String;\n\n\tgetSQLType(): string {\n\t\treturn 'numeric';\n\t}\n}\n\nexport type SQLiteNumericConfig<T extends 'string' | 'number' | 'bigint' = 'string' | 'number' | 'bigint'> = {\n\tmode: T;\n};\n\nexport function numeric<TMode extends SQLiteNumericConfig['mode']>(\n\tconfig?: SQLiteNumericConfig<TMode>,\n): Equal<TMode, 'number'> extends true ? SQLiteNumericNumberBuilder\n\t: Equal<TMode, 'bigint'> extends true ? SQLiteNumericBigIntBuilder\n\t: SQLiteNumericBuilder;\nexport function numeric<TMode extends SQLiteNumericConfig['mode']>(\n\tname: string,\n\tconfig?: SQLiteNumericConfig<TMode>,\n): Equal<TMode, 'number'> extends true ? SQLiteNumericNumberBuilder\n\t: Equal<TMode, 'bigint'> extends true ? SQLiteNumericBigIntBuilder\n\t: SQLiteNumericBuilder;\nexport function numeric(a?: string | SQLiteNumericConfig, b?: SQLiteNumericConfig) {\n\tconst { name, config } = getColumnNameAndConfig<SQLiteNumericConfig>(a, b);\n\tconst mode = config?.mode;\n\treturn mode === 'number'\n\t\t? new SQLiteNumericNumberBuilder(name)\n\t\t: mode === 'bigint'\n\t\t? new SQLiteNumericBigIntBuilder(name)\n\t\t: new SQLiteNumericBuilder(name);\n}\n"],"mappings":";;;;;AAMA,IAAa,uBAAb,cAA0C,oBAIvC;CACF,QAA0B,cAAsB;CAEhD,YAAY,MAAc;AACzB,QAAM,MAAM,kBAAkB,gBAAgB;;;CAI/C,AAAS,MAAM,OAAoB;AAClC,SAAO,IAAI,cACV,OACA,KAAK,OACL;;;AAIH,IAAa,gBAAb,cAAiF,aAAgB;CAChG,QAA0B,cAAsB;CAEhD,AAAS,mBAAmB,OAAwB;AACnD,MAAI,OAAO,UAAU,SAAU,QAAO;AAEtC,SAAO,OAAO,MAAM;;CAGrB,aAAqB;AACpB,SAAO;;;AAGT,IAAa,6BAAb,cAAgD,oBAI7C;CACF,QAA0B,cAAsB;CAEhD,YAAY,MAAc;AACzB,QAAM,MAAM,UAAU,sBAAsB;;;CAI7C,AAAS,MAAM,OAAoB;AAClC,SAAO,IAAI,oBACV,OACA,KAAK,OACL;;;AAIH,IAAa,sBAAb,cAA+E,aAAgB;CAC9F,QAA0B,cAAsB;CAEhD,AAAS,mBAAmB,OAAwB;AACnD,MAAI,OAAO,UAAU,SAAU,QAAO;AAEtC,SAAO,OAAO,MAAM;;CAGrB,AAAS,mBAAmB;CAE5B,aAAqB;AACpB,SAAO;;;AAIT,IAAa,6BAAb,cAAgD,oBAI7C;CACF,QAA0B,cAAsB;CAEhD,YAAY,MAAc;AACzB,QAAM,MAAM,gBAAgB,sBAAsB;;;CAInD,AAAS,MAAM,OAAoB;AAClC,SAAO,IAAI,oBACV,OACA,KAAK,OACL;;;AAIH,IAAa,sBAAb,cAAqF,aAAgB;CACpG,QAA0B,cAAsB;CAEhD,AAAS,qBAAqB;CAE9B,AAAS,mBAAmB;CAE5B,aAAqB;AACpB,SAAO;;;AAmBT,SAAgB,QAAQ,GAAkC,GAAyB;CAClF,MAAM,EAAE,MAAM,WAAW,uBAA4C,GAAG,EAAE;CAC1E,MAAM,OAAO,QAAQ;AACrB,QAAO,SAAS,WACb,IAAI,2BAA2B,KAAK,GACpC,SAAS,WACT,IAAI,2BAA2B,KAAK,GACpC,IAAI,qBAAqB,KAAK"}