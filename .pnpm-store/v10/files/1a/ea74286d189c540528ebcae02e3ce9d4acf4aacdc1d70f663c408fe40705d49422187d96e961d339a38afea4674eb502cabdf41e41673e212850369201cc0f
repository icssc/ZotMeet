{"version":3,"file":"key-isolation-MD7HBc2w.js","names":[],"sources":["../src/adapters/lib/key-isolation.ts"],"sourcesContent":["import { debug } from '../../lib/debug'\nimport { compareQuery } from '../../lib/compare'\n\nexport function applyChange(\n  newValue: URLSearchParams,\n  keys: string[],\n  copy: boolean\n): (oldValue: URLSearchParams) => URLSearchParams {\n  return (oldValue: URLSearchParams) => {\n    const hasChanged =\n      keys.length === 0\n        ? true\n        : keys.some(\n            key => !compareQuery(oldValue.getAll(key), newValue.getAll(key))\n          )\n    if (!hasChanged) {\n      debug(\n        '[nuqs `%s`] no change, returning previous',\n        keys.join(','),\n        oldValue\n      )\n      return oldValue\n    }\n    const filtered = filterSearchParams(newValue, keys, copy)\n    debug(\n      `[nuqs \\`%s\\`] subbed search params change\n  from %O\n  to   %O`,\n      keys.join(','),\n      oldValue,\n      filtered\n    )\n    return filtered\n  }\n}\n\nexport function filterSearchParams(\n  search: URLSearchParams,\n  keys: string[],\n  copy: boolean\n): URLSearchParams {\n  if (keys.length === 0) {\n    return search\n  }\n  const filtered = copy ? new URLSearchParams(search) : search\n  for (const key of search.keys()) {\n    if (!keys.includes(key)) {\n      filtered.delete(key)\n    }\n  }\n  return filtered\n}\n"],"mappings":";;;;AAGA,SAAgB,YACd,UACA,MACA,MACgD;AAChD,SAAQ,aAA8B;AAOpC,MAAI,EALF,KAAK,WAAW,IACZ,OACA,KAAK,MACH,QAAO,CAAC,aAAa,SAAS,OAAO,IAAI,EAAE,SAAS,OAAO,IAAI,CAAC,CACjE,GACU;AACf,SACE,6CACA,KAAK,KAAK,IAAI,EACd,SACD;AACD,UAAO;;EAET,MAAM,WAAW,mBAAmB,UAAU,MAAM,KAAK;AACzD,QACE;;YAGA,KAAK,KAAK,IAAI,EACd,UACA,SACD;AACD,SAAO;;;AAIX,SAAgB,mBACd,QACA,MACA,MACiB;AACjB,KAAI,KAAK,WAAW,EAClB,QAAO;CAET,MAAM,WAAW,OAAO,IAAI,gBAAgB,OAAO,GAAG;AACtD,MAAK,MAAM,OAAO,OAAO,MAAM,CAC7B,KAAI,CAAC,KAAK,SAAS,IAAI,CACrB,UAAS,OAAO,IAAI;AAGxB,QAAO"}