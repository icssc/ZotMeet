{"version":3,"file":"array.cjs","names":["result: any[]","value","startFrom"],"sources":["../../../src/pg-core/utils/array.ts"],"sourcesContent":["function parsePgArrayValue(arrayString: string, startFrom: number, inQuotes: boolean): [string, number] {\n\tfor (let i = startFrom; i < arrayString.length; i++) {\n\t\tconst char = arrayString[i];\n\n\t\tif (char === '\\\\') {\n\t\t\ti++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (char === '\"') {\n\t\t\treturn [arrayString.slice(startFrom, i).replace(/\\\\/g, ''), i + 1];\n\t\t}\n\n\t\tif (inQuotes) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (char === ',' || char === '}') {\n\t\t\treturn [arrayString.slice(startFrom, i).replace(/\\\\/g, ''), i];\n\t\t}\n\t}\n\n\treturn [arrayString.slice(startFrom).replace(/\\\\/g, ''), arrayString.length];\n}\n\nexport function parsePgNestedArray(arrayString: string, startFrom = 0): [any[], number] {\n\tconst result: any[] = [];\n\tlet i = startFrom;\n\tlet lastCharIsComma = false;\n\n\twhile (i < arrayString.length) {\n\t\tconst char = arrayString[i];\n\n\t\tif (char === ',') {\n\t\t\tif (lastCharIsComma || i === startFrom) {\n\t\t\t\tresult.push('');\n\t\t\t}\n\t\t\tlastCharIsComma = true;\n\t\t\ti++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tlastCharIsComma = false;\n\n\t\tif (char === '\\\\') {\n\t\t\ti += 2;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (char === '\"') {\n\t\t\tconst [value, startFrom] = parsePgArrayValue(arrayString, i + 1, true);\n\t\t\tresult.push(value);\n\t\t\ti = startFrom;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (char === '}') {\n\t\t\treturn [result, i + 1];\n\t\t}\n\n\t\tif (char === '{') {\n\t\t\tconst [value, startFrom] = parsePgNestedArray(arrayString, i + 1);\n\t\t\tresult.push(value);\n\t\t\ti = startFrom;\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst [value, newStartFrom] = parsePgArrayValue(arrayString, i, false);\n\t\tresult.push(value);\n\t\ti = newStartFrom;\n\t}\n\n\treturn [result, i];\n}\n\nexport function parsePgArray(arrayString: string): any[] {\n\tconst [result] = parsePgNestedArray(arrayString, 1);\n\treturn result;\n}\n\nexport function makePgArray(array: any[]): string {\n\treturn `{${\n\t\tarray.map((item) => {\n\t\t\tif (Array.isArray(item)) {\n\t\t\t\treturn makePgArray(item);\n\t\t\t}\n\n\t\t\tif (typeof item === 'string') {\n\t\t\t\treturn `\"${item.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '\\\\\"')}\"`;\n\t\t\t}\n\n\t\t\treturn `${item}`;\n\t\t}).join(',')\n\t}}`;\n}\n"],"mappings":";;AAAA,SAAS,kBAAkB,aAAqB,WAAmB,UAAqC;AACvG,MAAK,IAAI,IAAI,WAAW,IAAI,YAAY,QAAQ,KAAK;EACpD,MAAM,OAAO,YAAY;AAEzB,MAAI,SAAS,MAAM;AAClB;AACA;;AAGD,MAAI,SAAS,KACZ,QAAO,CAAC,YAAY,MAAM,WAAW,EAAE,CAAC,QAAQ,OAAO,GAAG,EAAE,IAAI,EAAE;AAGnE,MAAI,SACH;AAGD,MAAI,SAAS,OAAO,SAAS,IAC5B,QAAO,CAAC,YAAY,MAAM,WAAW,EAAE,CAAC,QAAQ,OAAO,GAAG,EAAE,EAAE;;AAIhE,QAAO,CAAC,YAAY,MAAM,UAAU,CAAC,QAAQ,OAAO,GAAG,EAAE,YAAY,OAAO;;AAG7E,SAAgB,mBAAmB,aAAqB,YAAY,GAAoB;CACvF,MAAMA,SAAgB,EAAE;CACxB,IAAI,IAAI;CACR,IAAI,kBAAkB;AAEtB,QAAO,IAAI,YAAY,QAAQ;EAC9B,MAAM,OAAO,YAAY;AAEzB,MAAI,SAAS,KAAK;AACjB,OAAI,mBAAmB,MAAM,UAC5B,QAAO,KAAK,GAAG;AAEhB,qBAAkB;AAClB;AACA;;AAGD,oBAAkB;AAElB,MAAI,SAAS,MAAM;AAClB,QAAK;AACL;;AAGD,MAAI,SAAS,MAAK;GACjB,MAAM,CAACC,SAAOC,eAAa,kBAAkB,aAAa,IAAI,GAAG,KAAK;AACtE,UAAO,KAAKD,QAAM;AAClB,OAAIC;AACJ;;AAGD,MAAI,SAAS,IACZ,QAAO,CAAC,QAAQ,IAAI,EAAE;AAGvB,MAAI,SAAS,KAAK;GACjB,MAAM,CAACD,SAAOC,eAAa,mBAAmB,aAAa,IAAI,EAAE;AACjE,UAAO,KAAKD,QAAM;AAClB,OAAIC;AACJ;;EAGD,MAAM,CAAC,OAAO,gBAAgB,kBAAkB,aAAa,GAAG,MAAM;AACtE,SAAO,KAAK,MAAM;AAClB,MAAI;;AAGL,QAAO,CAAC,QAAQ,EAAE;;AAGnB,SAAgB,aAAa,aAA4B;CACxD,MAAM,CAAC,UAAU,mBAAmB,aAAa,EAAE;AACnD,QAAO;;AAGR,SAAgB,YAAY,OAAsB;AACjD,QAAO,IACN,MAAM,KAAK,SAAS;AACnB,MAAI,MAAM,QAAQ,KAAK,CACtB,QAAO,YAAY,KAAK;AAGzB,MAAI,OAAO,SAAS,SACnB,QAAO,IAAI,KAAK,QAAQ,OAAO,OAAO,CAAC,QAAQ,MAAM,OAAM,CAAC;AAG7D,SAAO,GAAG;GACT,CAAC,KAAK,IAAI,CACZ"}